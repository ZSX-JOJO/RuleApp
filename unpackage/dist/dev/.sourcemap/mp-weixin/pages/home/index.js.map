{"version":3,"sources":["uni-app:///main.js","webpack:///E:/APPpro/voss/规则之树/pages/home/index.vue?0ebb","webpack:///E:/APPpro/voss/规则之树/pages/home/index.vue?28cf","webpack:///E:/APPpro/voss/规则之树/pages/home/index.vue?55d9","webpack:///E:/APPpro/voss/规则之树/pages/home/index.vue?3dc1","uni-app:///pages/home/index.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","isPost","paddingBottomHeight","list","text","icon","icon_a","type","curType","curStyle","curPage","announcement","isAnnouncement","versionCode","wgtVer","Update","versionUrl","versionTitle","versionIntro","startImg","localUrl","isStart","onBackPress","onPullDownRefresh","uni","onShow","setTimeout","that","onReachBottom","onShareAppMessage","title","onShareTimeline","onLoad","localStorage","success","console","model","onReady","methods","tabbarChange","closeUpdate","toLink","url","getAnnouncement","isUpdate","plus","animation","toStartUrl","toStart","appStartImg","Download","readAnnouncement","unreadNum","token","header","method","dataType","fail"],"mappings":";;;;;;;;;;;;;AAAA;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,cAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;;;AAGpD;AACsK;AACtK,gBAAgB,6KAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACtBA;AAAA;AAAA;AAAA;AAAinB,CAAgB,+mBAAG,EAAC,C;;;;;;;;;;;;;;;;;;ACyHroB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eACA;EACAC;IACA;MACAC;MACAC;MAAA;MACAC;QACAC;QACAC;QAAA;QACAC;QAAA;QACAC;MACA;QACAH;QACAC;QACAC;QACAC;MACA,GACA;QACAH;QACAC;QACAC;QACAC;MACA;QACAH;QACAC;QACAC;QACAC;MACA,EACA;MACAC;MACAC;MACAC;MAEAC;MACAC;MAEAC;MACAC;MAEAC;MACAC;MACAC;MACAC;MAEAC;QACAC;MACA;MACAC;IACA;EACA;EACAC;IACA;EACA;EACAC;IACA;IACAC;IACA;MACAA;IACA;EACA;EACAC;IACA;IACAC;MACAF;IACA;IAsBAG;EACA;EACA;EACAC;IACA;IACAJ;EACA;EAEAK;IACA;IACA;MACA;IAAA;IAEA;MACA;IAAA;IAEA;IACA;MACAC;IACA;IAEA;EAEA;EACAC;IACA;IACA;IACA;MACAD;IACA;IAEA;EACA;EAEAE;IACA;IACA;IACAC;IACAT;MACAU;QACA;QACAC;QACAC;UAEA;UACA;YACAT;UACA;QACA;MACA;IACA;IACAA;IAMAD;MACAC;IACA;IAIAA;;IAEA;IACA;IACA;IACAH;MACAG;IACA;EACA;EACAU;IACAX;MACAF;IACA;EACA;EACAc;IACAC;MACA;MACAZ;MACAA;MACAA;MACAA;MACAD;QACAF;MACA;IAEA;IACAgB;MACA;MACAb;MACA;MACA;MACA;IACA;IACAc;MACA;MACAd;MACA;QACAH;UACAM;UACAzB;QACA;QACA;MACA;MACAmB;QACAkB;MACA;IACA;IACAC;MACA;MACA;QACA;UACA;UACAhB;UACA;YACA;cACA;cACA;cACA;cACA;gBACAA;cACA;YACA;cACAA;YACA;UAEA;QACA;UACAQ;QACA;MACA;IACA;IACAS;MACA;MAEAC;QAEAlB;QACAA;QACA;QACA;QACA;UACA;YACA;YACA;YACA;YACA;cACAA;YACA;cACAA;YACA;YAEAA;YACAA;YACA;cACA;cACA;cACA;cACA;cACA;cACA;YAAA;YAGA;cACAQ;cACAX;gBACAsB;cACA;cACAnB;cACA;gBACA;kBACAkB;gBACA;cACA;YACA;UACA;YACAV;UACA;QAEA;MACA;IACA;IACA;IACAY;MACA;QACA;QACA;QACA;UACA;UACA;UACA,gCAaA;YACAvB;cACAkB;YACA;UACA;QAEA;UACA;QACA;MAEA;QACA;MACA;IACA;IACAM;MACA;MACArB;IACA;IACAsB;MAEA;IAgDA;IACAC;MACA;IAgDA;IACAC;MACA;MACAxB;MACA;MACAM;IAEA;IACAmB;MACA;MACA;MACA;QACA;QACAC;MAEA;MACA1B;QAEAe;QACA1C;UACA;QACA;QACAsD;UACA;QACA;QACAC;QACAC;QACAtB;UACA;YACA;YACAD;UACA;QACA;QACAwB;UACAjC;YACAM;YACAzB;UACA;QACA;MACA;IACA;EACA;AACA;AAAA,2B","file":"pages/home/index.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/uni-stat/dist/uni-stat.es.js';\nimport Vue from 'vue'\nimport Page from './pages/home/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=71e217db&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/home/index.vue\"\nexport default component.exports","export * from \"-!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=71e217db&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      _vm.isPost = false\n    }\n    _vm.e1 = function ($event) {\n      _vm.isPost = !_vm.isPost\n    }\n    _vm.e2 = function ($event) {\n      _vm.isAnnouncement = false\n    }\n    _vm.e3 = function ($event) {\n      _vm.isAnnouncement = false\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<home v-show=\"curType=='home'\" :curPage=\"0\"></home>\r\n\t\t<find v-show=\"curType=='find'\" :curPage=\"1\"></find>\r\n\t\t<square v-show=\"curType=='square'\" :curPage=\"2\"></square>\r\n\t\t<user v-show=\"curType=='user'\" :curPage=\"3\"></user>\r\n\t\t<view class=\"tabbar\" :style=\"{'padding-bottom': paddingBottomHeight + 'upx'}\" :class=\"$store.state.AppStyle\">\r\n\t\t\t<view class=\"tabbar-operate-bg\" :class=\"isPost?'show':''\" @tap=\"isPost=false\"></view>\r\n\t\t\t<view class=\"tabbar-operate\" :class=\"isPost?'show':''\" :style=\"{'padding-bottom': paddingBottomHeight + 'upx'}\">\r\n\t\t\t\t<view class=\"tabbar-operate-main grid col-3\">\r\n\t\t\t\t\t<view class=\"index-sort-box\">\r\n\t\t\t\t\t\t<view class=\"index-sort-main\"  @tap=\"toLink('../edit/articlePost?type=add')\">\r\n\t\t\t\t\t\t\t<view class=\"index-sort-i\" style=\"background: rgba(30, 134, 231, 0.2);\">\r\n\t\t\t\t\t\t\t\t<text class=\"cuIcon-writefill\" style=\"color:  #1e86e7;\"></text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"index-sort-text\">\r\n\t\t\t\t\t\t\t\t文章\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"index-sort-box\">\r\n\t\t\t\t\t\t<view class=\"index-sort-main\" @tap=\"toLink('../space/post?type=0')\">\r\n\t\t\t\t\t\t\t<view class=\"index-sort-i\" style=\"background: rgba(21, 159, 44, 0.2);\">\r\n\t\t\t\t\t\t\t\t<text class=\"cuIcon-creativefill\" style=\"color:  #159f2c;\"></text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"index-sort-text\">\r\n\t\t\t\t\t\t\t\t动态\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"index-sort-box\">\r\n\t\t\t\t\t\t<view class=\"index-sort-main\" @tap=\"toLink('../edit/addshop')\">\r\n\t\t\t\t\t\t\t<view class=\"index-sort-i\" style=\"background: rgba(255, 0, 127, 0.2);\">\r\n\t\t\t\t\t\t\t\t<text class=\"cuIcon-cartfill\" style=\"color:  #ff007f;\"></text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"index-sort-text\">\r\n\t\t\t\t\t\t\t\t商品\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<block  v-for=\"(item, index) in list\" \r\n\t\t\t\t    :key=\"index\">\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"tabbar-item\" @tap=\"tabbarChange(item.type,index)\">\r\n\t\t\t\t    <image class=\"item-img\" :src=\"item.icon_a+'.png'\" v-if=\"curType == item.type\"></image>\r\n\t\t\t\t    <image class=\"item-img\" :src=\"item.icon\" v-else></image>\r\n\t\t\t\t    <view class=\"item-name\" :class=\"{'tabbarActive': curType == item.type}\" v-if=\"item.text\">{{item.text}}</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"tabbar-item addPost\" v-if=\"index==1\" @tap=\"isPost=!isPost\" :class=\"isPost?'postShow':''\">\r\n\t\t\t\t\t<view class=\"addPost-main\">\r\n\t\t\t\t\t\t<view class=\"addPost-i\">\r\n\t\t\t\t\t\t\t <text class=\"cuIcon-add\"></text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</block>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!--弹窗公告-->\r\n\t\t<view class=\"announcement\" v-if=\"isAnnouncement&&Update!=1\">\r\n\t\t\t<view class=\"announcement-bg\" @tap=\"isAnnouncement=false\">\r\n\t\t\t\t\r\n\t\t\t</view>\r\n\t\t\t<view class=\"announcement-main\">\r\n\t\t\t\t<view class=\"announcement-title\">\r\n\t\t\t\t\t网站公告\r\n\t\t\t\t\t<text class=\"cuIcon-close text-red\" @tap=\"isAnnouncement=false\"></text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"announcement-concent\">\r\n\t\t\t\t\t<rich-text :nodes=\"announcement\"></rich-text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"announcement-btn\">\r\n\t\t\t\t\t<button class=\"cu-btn bg-gradual-blue lg\" @tap=\"readAnnouncement\">我知道了</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<!--update-->\r\n\t\t<!--  #ifdef APP-PLUS -->\r\n\t\t<view class=\"update\" v-if=\"Update==1\">\r\n\t\t\t<view class=\"update-bg\">\r\n\t\t\t\t\r\n\t\t\t</view>\r\n\t\t\t<view class=\"update-box\">\r\n\t\t\t\t<view class=\"update-main\">\r\n\t\t\t\t\t<image src=\"../../static/app-plus/ic_ar.png\"></image>\r\n\t\t\t\t\t<view class=\"update-title\">发现新版本：{{versionTitle}}</view>\r\n\t\t\t\t\t<view class=\"update-intro\"><rich-text :nodes=\"versionIntro\"></rich-text></view>\r\n\t\t\t\t\t<view class=\"update-btn grid col-2\">\r\n\t\t\t\t\t\t<view class=\"update-btn-box\">\r\n\t\t\t\t\t\t\t<view class=\"update-btn-main bg-blue\"  @tap=\"isUpdate(true)\">\r\n\t\t\t\t\t\t\t\t确定\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"update-btn-box\">\r\n\t\t\t\t\t\t\t<view class=\"update-btn-main bg-gray\" @tap=\"closeUpdate()\">\r\n\t\t\t\t\t\t\t\t取消\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<!--  #endif -->\r\n\t\t<!--#ifdef APP-PLUS-->\r\n\t\t<view class=\"Startupmap\" v-if=\"!isStart\">\r\n\t\t\t<view class=\"Startupmap-close\" @tap=\"toStart\">\r\n\t\t\t\t<text>跳过</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"Startupmap-pic\" @tap=\"toStartUrl\">\r\n\t\t\t\t<image :src=\"startImg.localUrl\"></image>\r\n\t\t\t\t<!-- <image src=\"_doc/uniapp_save/16631684216820.png\"></image> -->\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<!--#endif-->\r\n\t</view>\n\t\n</template>\n\n<script>\nimport { localStorage } from '../../js_sdk/mp-storage/mp-storage/index.js'\nexport default {\n    data() {\n        return {\r\n\t\t\tisPost:false,\n            paddingBottomHeight: 0,  //苹果X以上手机底部适配高度\n            list: [{\n                    text: '首页',  \n                    icon: '/static/tabbar/home.png',  //未选中图标\n                    icon_a: '/static/tabbar/home_cur',  //选中图片\n                    type: \"home\",\n                },{\n                    text: '发现',\n                    icon: '/static/tabbar/find.png',\n                    icon_a: '/static/tabbar/find_cur',\r\n\t\t\t\t\ttype: \"find\",\n                }\n                ,{\n                    text: '广场',\n                    icon: '/static/tabbar/square.png',\n                    icon_a: '/static/tabbar/square_cur',\n                    type: 'square',\n                },{\n                    text: '我的',\n                    icon: '/static/tabbar/user.png',\n                    icon_a: '/static/tabbar/user_cur',\n                    type: \"user\",\n                },\n            ],\r\n\t\t\tcurType:\"home\",\r\n\t\t\tcurStyle:\"blue\",\r\n\t\t\tcurPage:0,\r\n\t\t\t\r\n\t\t\tannouncement:\"\",\r\n\t\t\tisAnnouncement:false,\r\n\t\t\t\r\n\t\t\tversionCode:0,\r\n\t\t\twgtVer:'',\r\n\t\t\t\r\n\t\t\tUpdate:0,\r\n\t\t\tversionUrl:\"\",\r\n\t\t\tversionTitle:\"\",\r\n\t\t\tversionIntro:\"\",\r\n\t\t\t\r\n\t\t\tstartImg:{\r\n\t\t\t\tlocalUrl:\"\"\r\n\t\t\t},\r\n\t\t\tisStart:false,\n        };\n    },\r\n\tonBackPress(){\r\n\t\treturn true\r\n\t},\r\n\tonPullDownRefresh(){\r\n\t\tvar that = this;\r\n\t\tuni.$emit('onPullDownRefresh', that.curPage);\r\n\t\tvar timer = setTimeout(function() {\r\n\t\t\tuni.stopPullDownRefresh();\r\n\t\t}, 1000);\r\n\t},\r\n\tonShow() {\r\n\t\tvar that = this;\r\n\t\tsetTimeout(function() {\r\n\t\t\tuni.$emit('onShow', that.curPage);\r\n\t\t}, 200); \r\n\t\t// #ifdef APP-PLUS\r\n\t\t//外部启动APP处理\r\n\t\tvar args= plus.runtime.arguments;\r\n\t\tplus.runtime.arguments=null;\r\n\t\tplus.runtime.arguments=\"\";\r\n\t\tif(args){  \r\n\t\t\t\r\n\t\t\t//跳转到文章\r\n\t\t\tif(args.indexOf(\"?info=\") != -1){\r\n\t\t\t\tvar arr = args.split(\"?info=\");\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t    url: '/pages/contents/info?cid='+arr[1]\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t//判断是否是扫码登录\r\n\t\t\tif(args.indexOf(\"?scan=\") != -1){\r\n\t\t\t\tvar arr = args.split(\"?scan=\");\r\n\t\t\t\tthat.scanLogin(arr[1]);\r\n\t\t\t}\r\n\t\t}\r\n\t\t// #endif\r\n\t\tthat.unreadNum();\r\n\t},\r\n\t//触底监听\r\n\tonReachBottom() {\r\n\t\tvar that = this;\r\n\t\tuni.$emit('onReachBottom', that.curPage);\r\n\t},\r\n\t// #ifdef MP\r\n\tonShareAppMessage(res) {\r\n\t\tvar that = this;\r\n\t\tif (res.from === 'button') {\r\n\t\t\t// 来自页面内分享按钮\r\n\t\t}\r\n\t\tif (res.from === 'menu') {\r\n\t\t\t// 来自页面内分享按钮\r\n\t\t}\r\n\t\tvar title = that.$API.GetAppName();\r\n\t\tvar data = {\r\n\t\t\ttitle: title,\r\n\t\t}\r\n\t\t\r\n\t\treturn data;\r\n\t\r\n\t},\r\n\tonShareTimeline() {\r\n\t\tvar that = this;\r\n\t\tvar title = that.$API.GetAppName();\r\n\t\tvar data = {\r\n\t\t\ttitle: title,\r\n\t\t}\r\n\t\t\r\n\t\treturn data;\r\n\t},\r\n\t// #endif\n    onLoad() {\n        let that = this;\r\n\t\tlet platform=uni.getSystemInfoSync().platform;\r\n\t\tlocalStorage.setItem('app_platform',platform);\n        uni.getSystemInfo({\n            success: function (res) {\n                let model = ['X', 'XR', 'XS', '11', '12', '13', '14', '15'];\r\n\t\t\t\tconsole.log(\"当前设备型号：\"+res.model)\n                model.forEach(item => {\r\n\t\t\t\t\t\n                    //适配iphoneX以上的底部，给tabbar一定高度的padding-bottom\n                    if(res.model.indexOf(item) != -1 && res.model.indexOf('iPhone') != -1) {\n                        that.paddingBottomHeight = 40;\n                    }\n                })\n            }\n        });\r\n\t\tthat.getAnnouncement();\r\n\t\t// #ifdef APP-PLUS\r\n\t\tthat.isUpdate(false);\r\n\t\t// #endif\r\n\t\t\r\n\t\t\r\n\t\tsetTimeout(function() {\r\n\t\t\tthat.isStart=true;\r\n\t\t}, 5000); \r\n\t\t// #ifdef APP-PLUS\r\n\t\t that.appStartImg();\r\n\t\t //#endif\r\n\t\t that.unreadNum();\r\n\t\t \r\n\t\t // setTimeout(function() {\r\n\t\t // \tuni.$emit('onShow', 0);\r\n\t\t // }, 200); \r\n\t\tuni.$on('goUser', function(data) {\r\n\t\t\tthat.tabbarChange(\"user\",3)\r\n\t\t});\n    },\r\n\tonReady() {\r\n\t\tsetTimeout(function() {\r\n\t\t\tuni.$emit('onShow', 0);\r\n\t\t}, 200); \r\n\t},\n    methods: {\n        tabbarChange(type,index) {\r\n\t\t\tvar that = this;\r\n\t\t\tthat.isPost = false;\r\n\t\t\tthat.curPage = index;\n            that.curType = type;\r\n\t\t\tthat.unreadNum();\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tuni.$emit('onShow', index);\r\n\t\t\t}, 200); \r\n\t\t\t\n        },\r\n\t\tcloseUpdate(){\r\n\t\t\tvar that = this;\r\n\t\t\tthat.Update = 0;\r\n\t\t\t// uni.showTabBar({\r\n\t\t\t// \tanimation: true\r\n\t\t\t// });\r\n\t\t},\n\t\ttoLink(text){\n\t\t\tvar that = this;\n\t\t\tthat.isPost = false;\n\t\t\tif(!localStorage.getItem('token')||localStorage.getItem('token')==\"\"){\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: \"请先登录哦\",\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tuni.navigateTo({\n\t\t\t\turl: text\n\t\t\t});\n\t\t},\r\n\t\tgetAnnouncement(){\r\n\t\t\tvar that = this;\r\n\t\t\tif(localStorage.getItem('AppInfo')){\r\n\t\t\t\ttry{\r\n\t\t\t\t\tvar AppInfo = JSON.parse(localStorage.getItem('AppInfo'));\r\n\t\t\t\t\tthat.announcement = AppInfo.announcement;\r\n\t\t\t\t\tif(that.announcement!=\"\"||AppInfo.announcement){\r\n\t\t\t\t\t\tif(localStorage.getItem('isAnnouncement')){\r\n\t\t\t\t\t\t\tvar oldTime = Number(localStorage.getItem('isAnnouncement'));\r\n\t\t\t\t\t\t\tvar curTime=new Date().getTime();\r\n\t\t\t\t\t\t\tvar difference = curTime - oldTime;\r\n\t\t\t\t\t\t\tif(difference > 86400000){\r\n\t\t\t\t\t\t\t\tthat.isAnnouncement=true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthat.isAnnouncement=true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}catch(e){\r\n\t\t\t\t\tconsole.log(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tisUpdate(Status) {\r\n\t\t\tvar that = this;\r\n\t\t\t\r\n\t\t\tplus.runtime.getProperty(plus.runtime.appid, function(inf) {\r\n\t\t\t\t\r\n\t\t\t\tthat.wgtVer = inf.version //获取当前版本号\r\n\t\t\t\tthat.versionCode = inf.versionCode;\r\n\t\t\t\tvar version = inf.versionCode;\r\n\t\t\t\t//从缓存里读取版本号\r\n\t\t\t\tif(localStorage.getItem('AppInfo')){\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tvar AppInfo = JSON.parse(localStorage.getItem('AppInfo'));\r\n\t\t\t\t\t\tvar versionCode = AppInfo.versionCode;\r\n\t\t\t\t\t\tlet platform=uni.getSystemInfoSync().platform;\r\n\t\t\t\t\t\tif(platform=='ios'){\r\n\t\t\t\t\t\t\tthat.versionUrl =  AppInfo.iosUrl;\r\n\t\t\t\t\t\t}else if(platform=='android'){\r\n\t\t\t\t\t\t\tthat.versionUrl =  AppInfo.androidUrl;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthat.versionTitle = AppInfo.version;\r\n\t\t\t\t\t\tthat.versionIntro = AppInfo.versionIntro;\r\n\t\t\t\t\t\tif(Status){\r\n\t\t\t\t\t\t\t// uni.showToast({\r\n\t\t\t\t\t\t\t// \ttitle:\"检测完成\",\r\n\t\t\t\t\t\t\t// \ticon:'none',\r\n\t\t\t\t\t\t\t// \tduration: 1000,\r\n\t\t\t\t\t\t\t// \tposition:'bottom',\r\n\t\t\t\t\t\t\t// });\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(versionCode > version){\r\n\t\t\t\t\t\t\tconsole.log(\"有更新\");\r\n\t\t\t\t\t\t\tuni.hideTabBar({\r\n\t\t\t\t\t\t\tanimation: true\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tthat.Update=1;\r\n\t\t\t\t\t\t\tif(Status){\r\n\t\t\t\t\t\t\t\tif(that.versionUrl!=\"\"){\r\n\t\t\t\t\t\t\t\t\tplus.runtime.openURL(that.versionUrl);  \r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}catch(e){\r\n\t\t\t\t\t\tconsole.log(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//自定义启动图广告相关\r\n\t\ttoStartUrl(){\r\n\t\t\tif(localStorage.getItem('appStart')){\r\n\t\t\t\tvar imgData = JSON.parse(localStorage.getItem('appStart'));\r\n\t\t\t\t//如果线上的图片与本地缓存图片相同，就不再进行下载\r\n\t\t\t\tif(imgData.url){\r\n\t\t\t\t\tvar url = imgData.url;\r\n\t\t\t\t\tvar type = imgData.urltype;\r\n\t\t\t\t\tif(url.indexOf(\"http\") != -1){\r\n\t\t\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\t\t\tif(type==1){\r\n\t\t\t\t\t\t\tplus.runtime.openURL(url);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(type==0){\r\n\t\t\t\t\t\t\tplus.runtime.openWeb(url);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t// #ifdef H5\r\n\t\t\t\t\t\twindow.open(url)\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t    url: url\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}else{\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}else{\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t},\r\n\t\ttoStart(){\r\n\t\t\tvar that = this;\r\n\t\t\tthat.isStart=true;\r\n\t\t},\r\n\t\tappStartImg(){\r\n\t\t\t\r\n\t\t\tvar that = this;\r\n\t\t\t// #ifdef APP-PLUS\r\n\t\t\tif(localStorage.getItem('appStart')){\r\n\t\t\t\tvar imgData = JSON.parse(localStorage.getItem('appStart'));\r\n\t\t\t\t\r\n\t\t\t\tif(!imgData.localUrl||imgData.localUrl==\"\"){\r\n\t\t\t\t\tconsole.log(\"启动图文件本地不存在\");\r\n\t\t\t\t\tlocalStorage.removeItem('appStart');\r\n\t\t\t\t\tthat.isStart=true;\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar localUrl = imgData.localUrl;\r\n\t\t\t\t//在请求之前，先为了性能载入上次图片\r\n\t\t\t\tplus.io.resolveLocalFileSystemURL(imgData.localUrl, function(entry) {\r\n\t\t\t\t\tconsole.log(\"启动图文件本地存在\");\r\n\t\t\t\t\timgData.localUrl = localUrl;\r\n\t\t\t\t\tthat.startImg = imgData;\r\n\t\t\t\t\r\n\t\t\t\t\tthat.isStart=false;\r\n\t\t\t\t}, function(e) {\r\n\t\t\t\t\tconsole.log(\"启动图文件本地不存在\");\r\n\t\t\t\t\tlocalStorage.removeItem('appStart');\r\n\t\t\t\t\tthat.isStart=true;\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tconsole.log(\"启动图未缓存\")\r\n\t\t\t}\r\n\t\t\tif(localStorage.getItem('startAds')){\r\n\t\t\t\tvar data =JSON.parse(localStorage.getItem('startAds'));\r\n\t\t\t\tvar adsNum = data.length;\r\n\t\t\t\tif(adsNum>0){\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar adsRand = Math.floor(Math.random()*adsNum);\r\n\t\t\t\t\tvar appStartPic = data[adsRand].img;\r\n\t\t\t\t\tif(appStartPic!=\"\"){\r\n\t\t\t\t\t\tappStartPic = appStartPic.replace(/[\\r\\n]/g,\"\");\r\n\t\t\t\t\t\tvar imgData = data[adsRand];\r\n\t\t\t\t\t\timgData.appStartPic = appStartPic;\r\n\t\t\t\t\t\tthat.Download(imgData);\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tconsole.log(\"广告信息不存在，删除缓存\");\r\n\t\t\t\t\tlocalStorage.removeItem('appStart');\r\n\t\t\t\t\tthat.isStart=true;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\tDownload(startImg) {\r\n\t\t\tvar that = this;\r\n\t\t\t// #ifdef APP-PLUS\r\n\t\t\tvar url = startImg.appStartPic;\r\n\t\t\tif(localStorage.getItem('appStart')){\r\n\t\t\t\tvar imgData = JSON.parse(localStorage.getItem('appStart'));\r\n\t\t\t\t//如果线上的图片与本地缓存图片相同，就不再进行下载\r\n\t\t\t\tif(url == imgData.appStartPic){\r\n\t\t\t\t\tconsole.log(\"启动图不更新\");\r\n\t\t\t\t\t//但是链接可能变化，所以需要载入缓存\r\n\t\t\t\t\tvar oldStartImg = imgData;\r\n\t\t\t\t\tlocalStorage.setItem('appStart', JSON.stringify(oldStartImg));\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tuni.downloadFile({\r\n\t\t\t\turl:url,//下载地址接口返回\r\n\t\t\t\tsuccess: (data) => {\r\n\t\t\t\t\tif (data.statusCode === 200) {\r\n\t\t\t\t\t\t//文件保存到本地\r\n\t\t\t\t\t\tuni.saveFile({\r\n\t\t\t\t\t\t\ttempFilePath: data.tempFilePath, //临时路径\r\n\t\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\t\t// uni.showToast({\r\n\t\t\t\t\t\t\t\t// \ticon: 'none',\r\n\t\t\t\t\t\t\t\t// \tmask: true,\r\n\t\t\t\t\t\t\t\t// \ttitle: '文件已保存：' + res.savedFilePath, //保存路径\r\n\t\t\t\t\t\t\t\t// \tduration: 3000,\r\n\t\t\t\t\t\t\t\t// });\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tstartImg.localUrl = res.savedFilePath;\r\n\t\t\t\t\t\t\t\tlocalStorage.setItem('appStart', JSON.stringify(startImg));\r\n\t\t\t\t\t\t\t\tconsole.log(\"启动图已更新\"+startImg.localUrl);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tthat.startImg = startImg;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t// uni.showToast({\r\n\t\t\t\t\t// \ticon: 'none',\r\n\t\t\t\t\t// \tmask: true,\r\n\t\t\t\t\t// \ttitle: '失败请重新下载',\r\n\t\t\t\t\t// });\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\treadAnnouncement(){\r\n\t\t\tvar that = this;\r\n\t\t\tthat.isAnnouncement = false;\r\n\t\t\tvar timestamp=new Date().getTime();\r\n\t\t\tlocalStorage.setItem('isAnnouncement',timestamp);\r\n\t\t\t\r\n\t\t},\r\n\t\tunreadNum() {\r\n\t\t\tvar that = this;\r\n\t\t\tvar token = \"\"\r\n\t\t\tif(localStorage.getItem('userinfo')){\r\n\t\t\t\tvar userInfo = JSON.parse(localStorage.getItem('userinfo'));\r\n\t\t\t\ttoken=userInfo.token;\r\n\t\t\t\r\n\t\t\t}\r\n\t\t\tthat.$Net.request({\r\n\t\t\t\t\r\n\t\t\t\turl: that.$API.unreadNum(),\r\n\t\t\t\tdata:{\r\n\t\t\t\t\t\"token\":token\r\n\t\t\t\t},\r\n\t\t\t\theader:{\r\n\t\t\t\t\t'Content-Type':'application/x-www-form-urlencoded'\r\n\t\t\t\t},\r\n\t\t\t\tmethod: \"get\",\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\tif(res.data.code==1){\r\n\t\t\t\t\t\tvar noticeSum = res.data.data;\r\n\t\t\t\t\t\tlocalStorage.setItem('noticeSum',noticeSum);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: function(res) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: \"网络开小差了哦\",\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\n    }\n};\n</script>\n\n<style>\n    \n</style>\n"],"sourceRoot":""}