{"version":3,"sources":["webpack:///E:/APPpro/voss/规则之树/pages/tabPage/square.vue?2a33","webpack:///E:/APPpro/voss/规则之树/pages/tabPage/square.vue?7064","webpack:///E:/APPpro/voss/规则之树/pages/tabPage/square.vue?1358","webpack:///E:/APPpro/voss/规则之树/pages/tabPage/square.vue?5025","uni-app:///pages/tabPage/square.vue"],"names":["props","curPage","type","default","name","data","StatusBar","CustomBar","NavBar","AppStyle","userInfo","token","isLoading","toolid","noticeSum","squareid","searchText","chatList","oldChatList","spaceList","isGetChat","uid","dataLoad","page","moreText","noLogin","mounted","uni","console","that","beforeDestroy","clearInterval","methods","allCache","setSquare","loadMore","searchClose","formatDate","month","date","hour","minute","toInfo","url","toPage","toSearch","goPage","toCategoryContents","userStatus","header","method","dataType","success","localStorage","fail","title","icon","toLink","toGroup","unreadNum","getMyChat","duration","position","arr","unRead","arraysEqual","chatFormatDate","result","goChat","chatlist","postSpace","getSpaceList","list","goUserInfo","goLogin","goRegister","subText","components","waves"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmH;AACnH;AAC0D;AACL;;;AAGrD;AACsK;AACtK,gBAAgB,6KAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,iFAAM;AACR,EAAE,0FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACnCA;AAAA;AAAA;AAAA;AAAknB,CAAgB,gnBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;ACiLtoB;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA,eACA;EACAA;IACAC;MACAC;MACAC;IACA;EACA;EACAC;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MAEAC;MACAC;MACAC;MACAC;MAEAC;MAEAC;MACAC;MAEAC;MACAC;MAEAC;MAEAC;MAEAC;MACAC;MAEAC;MACAC;MAEAC;IAGA;EACA;EACAC;IACA;IACAC;MACA;QACA;MACA;MACAC;MAEA;QACAC;MACA;MAEA;QAEAA;QACAA;QACAA;MACA;MACA;QAEAA;MACA;MACA;QACAA;QACA;MACA;;MACAA;MACAA;MACAA;IAEA;IAEAF;MACA;QACA;MACA;MACAC;MACA;QAEAC;MACA;IACA;IAEAF;MACA;QACA;MACA;MACAC;MACAC;MACAA;IACA;IAEAA;EAEA;EACAC;IACA;IACAH;IACAA;IACAA;IACAI;IACAF;EACA;EACAG;IACA;IACAC;MACA;MACA;QACAJ;MACA;IACA;IACAK;MACA;MACA;QACAL;MACA;MACAD;MACAC;MACAE;MACAF;MACA;QACA;UACAA;QACA;MACA;MACA;QACA;UACAA;UACAA;YACAA;UACA;QACA;MACA;IACA;IACAM;MACA;MACAN;MACAA;MACA;QACAA;MACA;IACA;IACAO;MACA;MACAP;MACAA;MACAA;IACA;IACAQ;MACA;MACA;MACA;QACAC;QACAC;QACAC;QACAC;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACAX;MACAF;MACAF;QACAgB;MACA;IACA;IACAC;MACA;MACAb;MACAF;MACAF;QACAgB;MACA;IACA;IACAE;MACA;MACA;QACAlB;UACAgB;QACA;QACA;MACA;MACAZ;MACAF;MACAF;QACAgB;MACA;IACA;IACAG;MACA;MACAf;MACAF;MACAF;QACAgB;MACA;IACA;IACAI;MACA;MACAhB;MACAF;MACA;MACAF;QACAgB;MACA;IACA;IACAK;MACA;MACAnB;QAEAc;QACAtC;UACA;QACA;QACA4C;UACA;QACA;QACAC;QACAC;QACAC;UACAvB;UACA;YACAwB;YACAA;YACAxB;YACAA;UACA;QACA;QACAyB;UACA3B;YACA4B;YACAC;UACA;QACA;MACA;IACA;IACAC;MACA;MAEA;QACA9B;UACA4B;UACAC;QACA;QACA;MACA;MACA7B;QACAgB;MACA;IACA;IACAe;MACA;IAOA;IACAC;MACA;MACA;QACA9B;MACA;IACA;IAEA;IACA+B;MACA;MACA;MACA;QACArC;MACA;MACA;QACAI;UACA4B;UACAC;UACAK;UACAC;QACA;QACA;MACA;MACAjC;QACAc;QACAtC;UACA;UACA;UACA;UACA;UACA;QACA;QACA4C;UACA;QACA;QACAC;QACAC;QACAC;UACAvB;UACAA;UACA;YACA;YACA;cACA;cACA;gBACA;gBACAkC;gBACAA;gBACA9C;cACA;cACA;gBACAY;gBACAA;cACA;gBACA;gBACA;kBACAX;gBACA;gBACA;kBAEA;oBACAU;oBACA;sBACA;wBACA;0BACA;4BACAA;4BACAX;4BAEA;4BACA;8BACA+C;4BACA;4BACA/C;0BACA;wBACA;sBAEA;oBACA;oBACAY;oBACAA;oBACAwB;kBACA;gBAGA;kBACAxB;kBACAA;kBACAwB;gBACA;cACA;YACA;cACA;YAAA;UAGA;QACA;QACAC;UACAzB;UACAA;UACA;QACA;MACA;IACA;IACAoC;MACA;MACA;MACA;MACA;QACA;UACA;YACA;cACA;YACA;UACA;QAEA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MAEA;MACA;MACA;MACA;MACA;MACA;MACA;QACA;UACA;YACAC;UACA;YACAA;UACA;QACA;UACAA;QACA;MACA;QACAA;MACA;MACA;IACA;IACAC;MACA;MACA;MACArC;MACAF;MACA;MACA;MACA;QACA;UACAwC;UACAA;QACA;MACA;MACAxC;MACAA;MACAwB;MACA;MACA;QACA;QACA;QAEA1B;UACAgB;QACA;MACA;MACA;QACA;QAEAhB;UACAgB;QACA;MACA;IAEA;IACA2B;MACA;MACA;QACA3C;UACAgB;QACA;MACA;QACAhB;UACAgB;QACA;MACA;QACAhB;UACAgB;QACA;MACA;IAGA;IACA4B;MACA;MACA;MACA;QACAhD;MACA;MACA;QACA;MACA;MACA;MACA;QACA;QACAZ;MAEA;MACAkB;QACAc;QACAtC;UACA;UACA;UACA;UACA;UACA;QACA;QACA6C;QACAC;QACAC;UACAvB;UACAA;UACAA;UACA;YACAA;UACA;UACA;YACAA;YACA;YACA;YACA;cACA;gBACA;kBACA;kBACA2C;gBACA;kBACAA;gBACA;cAEA;cACA;gBACA;kBACA;kBACAA;gBACA;kBACAA;gBACA;cAEA;YACA;YACArD;YACA;cACA;gBACAU;gBACAA;cACA;gBACAA;cACA;cACAwB;YACA;cACAxB;YACA;UAEA;YACA;cACAA;YACA;UACA;QACA;QACAyB;UACAzB;UACAA;UACAA;QACA;MACA;IACA;IAEA4C;MAEA;MACA;QACA9C;UACAgB;QACA;QACA;MACA;MACAhB;QACAgB;MACA;IACA;IACA+B;MACA/C;QACAgB;MACA;IACA;IACAgC;MACAhD;QACAgB;MACA;IACA;IACAiC;MACA;QACA;MACA;QACA;MACA;IAEA;EAAA,iCACA;IACAjD;MACAgB;IACA;EACA,EACA;EAQAkC;IACAC;EACA;AAGA;AAAA,2B","file":"pages/tabPage/square.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./square.vue?vue&type=template&id=b09362fe&\"\nvar renderjs\nimport script from \"./square.vue?vue&type=script&lang=js&\"\nexport * from \"./square.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/tabPage/square.vue\"\nexport default component.exports","export * from \"-!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./square.vue?vue&type=template&id=b09362fe&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.squareid == 0 ? _vm.spaceList.length : null\n  var g1 = _vm.squareid == 0 ? _vm.dataLoad && _vm.chatList.length > 0 : null\n  var g2 = _vm.squareid == 1 && _vm.token != \"\" ? _vm.chatList.length : null\n  var l0 =\n    _vm.squareid == 1 && _vm.token != \"\"\n      ? _vm.__map(_vm.chatList, function (item, index) {\n          var $orig = _vm.__get_orig(item)\n          var g3 = item.name.indexOf(_vm.searchText)\n          var m0 = g3 != -1 ? _vm.chatFormatDate(item.lastTime) : null\n          return {\n            $orig: $orig,\n            g3: g3,\n            m0: m0,\n          }\n        })\n      : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        g2: g2,\n        l0: l0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./square.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./square.vue?vue&type=script&lang=js&\"","<template>\n\t<view :class=\"$store.state.AppStyle\">\n\t\t<view class=\"header\" :style=\"[{height:CustomBar + 'px'}]\">\n\t\t\t<view class=\"cu-bar bg-white\" :style=\"{'height': CustomBar + 'px','padding-top':StatusBar + 'px'}\">\n\t\t\t\t<view class=\"action\">\n\t\t\t\t\t<text class=\"square-box\" :class=\"squareid==0?'cur':''\" @tap=\"setSquare(0,true)\">动态</text>\n\t\t\t\t\t<text class=\"square-box\" :class=\"squareid==1?'cur':''\" @tap=\"setSquare(1,true)\">群聊</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"content text-bold\" :style=\"[{top:StatusBar + 'px'}]\">\n\t\t\t\t\t\n\t\t\t\t</view>\n\t\t\t\t<!--  #ifdef H5 || APP-PLUS -->\n\t\t\t\t<view class=\"action\" @tap=\"toSearch\">\n\t\t\t\t\t<text class=\"cuIcon-search\"></text>\n\t\t\t\t</view>\n\t\t\t\t<!--  #endif -->\n\t\t\t</view>\n\t\t</view>\n\t\t<view :style=\"[{padding:NavBar + 'px 10px 0px 10px'}]\"></view>\n\t\t<block v-if=\"squareid==0\">\n\t\t\t<view class=\"data-box\">\n\t\t\t\t<view class=\"square-post\">\n\t\t\t\t\t<view class=\"square-post-header\">\n\t\t\t\t\t\t<view class=\"square-user\" @tap=\"goUserInfo()\">\n\t\t\t\t\t\t\t<view class=\"cu-avatar round\" :style=\"userInfo.style\" v-if=\"token!=''\"></view>\n\t\t\t\t\t\t\t<view class=\"cu-avatar round\" v-else>\n\t\t\t\t\t\t\t\t<text class=\"text-blue text-sm\">登录</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"square-text\" @tap=\"postSpace(0)\">\n\t\t\t\t\t\t\t分享你的想法吧！\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"square-post-btn grid col-4\">\n\t\t\t\t\t\t<view class=\"square-post-btn-box\" @tap=\"postSpace(0)\">\n\t\t\t\t\t\t\t<text class=\"cuIcon-pic text-green\"></text>图片\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"square-post-btn-box\" @tap=\"postSpace(4)\">\n\t\t\t\t\t\t\t<text class=\"cuIcon-record text-purple\"></text>视频\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"square-post-btn-box\" @tap=\"postSpace(1)\">\n\t\t\t\t\t\t\t<text class=\"cuIcon-read text-blue\"></text>文章\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"square-post-btn-box\" @tap=\"postSpace(5)\">\n\t\t\t\t\t\t\t<text class=\"cuIcon-cart text-red\"></text>商品\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<view class=\"no-data\" v-if=\"spaceList.length==0\">\n\t\t\t\t<text class=\"cuIcon-text\"></text>\n\t\t\t\t\n\t\t\t\t暂时没有动态哦！\n\t\t\t\t<view class=\"text-center margin-top-sm\">\n\t\t\t\t\t<text class=\"cu-btn bg-gradual-orange radius\" @tap=\"postSpace(0)\">我要发布</text>\n\t\t\t\t\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t</view>\n\t\t\t\t\n\t\t\t<spaceItem :spaceList=\"spaceList\"></spaceItem>\n\t\t\t<view class=\"load-more\" @tap=\"loadMore\" v-if=\"dataLoad&&chatList.length>0\">\n\t\t\t\t<text>{{moreText}}</text>\n\t\t\t</view>\n\t\t\t\n\t\t\t\n\t\t</block>\n\t\t<block v-if=\"squareid==1\">\n\t\t\t\n\t\t\t<view class=\"no-data\" v-if=\"token==''\">\n\t\t\t\t<text class=\"cuIcon-text\"></text>\n\t\t\t\t\n\t\t\t\t请先登录哦！\n\t\t\t\t<view class=\"text-center margin-top-sm\">\n\t\t\t\t\t<text class=\"cu-btn bg-blue radius\" @tap=\"goLogin()\">登录</text>\n\t\t\t\t\t<text class=\"cu-btn line-blue margin-left-sm radius\" @tap=\"goRegister()\">注册</text>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t</view>\n\t\t\t<view class=\"cu-list menu-avatar\" v-if=\"token!=''\">\n\t\t\t\t<view class=\"cu-bar bg-white search\">\n\t\t\t\t\t<view class=\"search-form round\">\n\t\t\t\t\t\t<text class=\"cuIcon-search\"></text>\n\t\t\t\t\t\t<input type=\"text\" placeholder=\"搜索群聊\" v-model=\"searchText\"></input>\n\t\t\t\t\t\t<view class=\"search-close\" v-if=\"searchText!=''\" @tap=\"searchClose()\"><text class=\"cuIcon-close\"></text></view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"no-data\" v-if=\"chatList.length==0\">\n\t\t\t\t\t<text class=\"cuIcon-text\"></text>\n\t\t\t\t\t暂时没有数据\n\t\t\t\t</view>\n\t\t\t\t<block v-for=\"(item,index) in chatList\" :key=\"index\">\n\t\t\t\t<view class=\"cu-item\" @tap=\"goChat(item)\" v-if=\"item.name.indexOf(searchText)!=-1\">\n\t\t\t\t\t<block v-if=\"item.type==1\">\n\t\t\t\t\t\t<view class=\"cu-avatar round lg\" :style=\"'background-image:url('+item.pic+');'\"></view>\n\t\t\t\t\t</block>\n\t\t\t\t\t<block v-else>\n\t\t\t\t\t\t<view class=\"cu-avatar round lg\" :style=\"'background-image:url('+item.userJson.avatar+');'\"></view>\n\t\t\t\t\t</block>\n\t\t\t\t\t<view class=\"content\">\n\t\t\t\t\t\t<view><view class=\"text-cut\">{{item.name}}</view></view>\n\t\t\t\t\t\t<view class=\"text-gray text-sm flex\">\n\t\t\t\t\t\t\t<view class=\"text-cut\">\n\t\t\t\t\t\t\t\t<block v-if=\"item.lastMsg!=null\">\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<block v-if=\"item.lastMsg.type!=4\">\n\t\t\t\t\t\t\t\t\t\t<block v-if=\"item.lastMsg.uid==uid\">\n\t\t\t\t\t\t\t\t\t\t\t我: \n\t\t\t\t\t\t\t\t\t\t</block>\n\t\t\t\t\t\t\t\t\t\t<block v-if=\"item.lastMsg.uid!=uid\">\n\t\t\t\t\t\t\t\t\t\t\t{{item.name}}: \n\t\t\t\t\t\t\t\t\t\t</block>\n\t\t\t\t\t\t\t\t\t\t<block v-if=\"item.lastMsg.type==0\">\n\t\t\t\t\t\t\t\t\t\t\t{{item.lastMsg.text}}\n\t\t\t\t\t\t\t\t\t\t</block>\n\t\t\t\t\t\t\t\t\t\t<block v-if=\"item.lastMsg.type==1\">\n\t\t\t\t\t\t\t\t\t\t\t[图片]\n\t\t\t\t\t\t\t\t\t\t</block>\n\t\t\t\t\t\t\t\t\t</block>\n\t\t\t\t\t\t\t\t\t<block v-else>\n\t\t\t\t\t\t\t\t\t\t<block v-if=\"item.lastMsg.text=='ban'\">\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"text-red\">[已开启全体禁言]</text>\n\t\t\t\t\t\t\t\t\t\t</block>\n\t\t\t\t\t\t\t\t\t\t<block v-else>\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"text-blue\">[已解除全体禁言]</text>\n\t\t\t\t\t\t\t\t\t\t</block>\n\t\t\t\t\t\t\t\t\t</block>\n\t\t\t\t\t\t\t\t</block>\n\t\t\t\t\t\t\t\t<block v-else>暂无消息</block>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"action\">\n\t\t\t\t\t\t<view class=\"text-grey text-xs\">{{chatFormatDate(item.lastTime)}}</view>\n\t\t\t\t\t\t<block v-if=\"item.lastMsg!=null\">\n\t\t\t\t\t\t\t<block v-if=\"item.lastMsg.uid==uid\">\n\t\t\t\t\t\t\t\t<view class=\"cu-tag sm\" style=\"background: none;\">&nbsp</view>\n\t\t\t\t\t\t\t</block>\n\t\t\t\t\t\t\t<block v-else>\n\t\t\t\t\t\t\t\t<view class=\"cu-tag sm\" style=\"background: none;\" v-if=\"item.isNew==0\">&nbsp</view>\n\t\t\t\t\t\t\t\t<view class=\"cu-tag round bg-red sm\" v-else>{{item.unRead}}</view>\n\t\t\t\t\t\t\t</block>\n\t\t\t\t\t\t</block>\n\t\t\t\t\t\t<block v-else>\n\t\t\t\t\t\t\t<view class=\"cu-tag sm\" style=\"background: none;\">&nbsp</view>\n\t\t\t\t\t\t</block>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t</block>\n\t\t\t</view>\n\t\t</block>\n\t\t<!--加载遮罩-->\n\t\t<view class=\"loading\" v-if=\"isLoading==0\">\n\t\t\t<view class=\"loading-main\">\n\t\t\t\t<image src=\"../../static/loading.gif\"></image>\n\t\t\t</view>\n\t\t</view>\n\t\t<!--加载遮罩结束-->\n\t\t<view class=\"full-noLogin\" v-if=\"noLogin\">\n\t\t\t<view class=\"full-noLogin-main\">\n\t\t\t\t<view class=\"full-noLogin-text\">\n\t\t\t\t\t您需要登录后才可以查看内容哦！\n\t\t\t\t</view>\n\t\t\t\t<view class=\"full-noLogin-btn\">\n\t\t\t\t\t<view class=\"cu-btn bg-blue\" @tap=\"goLogin()\">\n\t\t\t\t\t\t立即登录\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\r\n\t\t\n\t\t<view style=\"width: 100%; height: 130upx;\"></view>\n\t</view>\n</template>\n\n<script>\n\timport waves from '@/components/xxley-waves/waves.vue';\n\timport { localStorage } from '../../js_sdk/mp-storage/mp-storage/index.js'\n\texport default {\r\n\t\tprops: {\r\n\t\t\tcurPage: {\r\n\t\t\t  type: Number,\r\n\t\t\t  default: 0\r\n\t\t\t}\r\n\t\t},\r\n\t\tname: \"square\",\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tStatusBar: this.StatusBar,\n\t\t\t\tCustomBar: this.CustomBar,\n\t\t\t\tNavBar:this.StatusBar +  this.CustomBar,\n\t\t\t\tAppStyle:this.$store.state.AppStyle,\n\t\t\t\t\n\t\t\t\tuserInfo:null,\n\t\t\t\ttoken:\"\",\n\t\t\t\tisLoading:0,\n\t\t\t\ttoolid:0,\n\t\t\t\t\n\t\t\t\tnoticeSum:0,\n\t\t\t\t\n\t\t\t\tsquareid: 0,\n\t\t\t\tsearchText:\"\",\n\t\t\t\t\n\t\t\t\tchatList:[],\n\t\t\t\toldChatList:[],\n\t\t\t\t\n\t\t\t\tspaceList:[],\n\t\t\t\t\n\t\t\t\tisGetChat:null,\n\t\t\t\t\n\t\t\t\tuid:0,\n\t\t\t\tdataLoad:false,\n\t\t\t\t\n\t\t\t\tpage:1,\n\t\t\t\tmoreText:\"加载更多\",\n\t\t\t\t\n\t\t\t\tnoLogin:false\n\t\t\t\t\n\t\t\t\t\n\t\t\t}\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tvar that = this;\r\n\t\t\tuni.$on('onShow', function(data) {\r\n\t\t\t\tif(Number(data)!=Number(that.curPage)){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(\"触发Tab-\"+data+\"||页面下标\"+that.curPage);\r\n\t\t\t\t\r\n\t\t\t\tif(that.page == 1){\r\n\t\t\t\t\tthat.allCache();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(localStorage.getItem('userinfo')){\r\n\t\t\t\t\t\r\n\t\t\t\t\tthat.userInfo = JSON.parse(localStorage.getItem('userinfo'));\r\n\t\t\t\t\tthat.userInfo.style = \"background-image:url(\"+that.userInfo.avatar+\");\";\r\n\t\t\t\t\tthat.uid = that.userInfo.uid;\r\n\t\t\t\t}\r\n\t\t\t\tif(localStorage.getItem('token')){\r\n\t\t\t\t\t\r\n\t\t\t\t\tthat.token = localStorage.getItem('token');\r\n\t\t\t\t}\r\n\t\t\t\tif(localStorage.getItem('chatList')){\r\n\t\t\t\t\tthat.oldChatList = JSON.parse(localStorage.getItem('chatList'));\r\n\t\t\t\t\t// that.chatList = JSON.parse(localStorage.getItem('chatList'));\r\n\t\t\t\t}\r\n\t\t\t\tthat.userStatus();\r\n\t\t\t\tthat.unreadNum();\r\n\t\t\t\tthat.setSquare(that.squareid,false);\r\n\t\t\t\t\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tuni.$on('onReachBottom', function(data) {\r\n\t\t\t\tif(Number(data)!=Number(that.curPage)){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(\"触发触底刷新\");\r\n\t\t\t\tif(that.isLoad==0){\r\n\t\t\t\t\t\r\n\t\t\t\t\tthat.loadMore();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tuni.$on('onPullDownRefresh', function(data) {\r\n\t\t\t\tif(Number(data)!=Number(that.curPage)){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(\"触发下拉刷新\");\r\n\t\t\t\tthat.page = 1;\r\n\t\t\t\tthat.setSquare(that.squareid,true);\r\n\t\t\t});\r\n\t\t\t// #ifdef APP-PLUS || MP\r\n\t\t\tthat.NavBar = this.CustomBar;\r\n\t\t\t// #endif\t\r\n\t\t},\r\n\t\tbeforeDestroy(){\r\n\t\t\tvar that = this;\r\n\t\t\tuni.$off('onReachBottom')\r\n\t\t\tuni.$off('onShow')\r\n\t\t\tuni.$off('onPullDownRefresh')\r\n\t\t\tclearInterval(that.isGetChat);\r\n\t\t\tthat.isGetChat = null\r\n\t\t},\n\t\tmethods:{\r\n\t\t\t//公共缓存\r\n\t\t\tallCache(){\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tif(localStorage.getItem('spaceList')){\r\n\t\t\t\t\tthat.spaceList = JSON.parse(localStorage.getItem('spaceList'));\r\n\t\t\t\t}\r\n\t\t\t},\n\t\t\tsetSquare(type,reset){\n\t\t\t\tvar that = this;\r\n\t\t\t\tif(reset){\r\n\t\t\t\t\tthat.page = 1;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(\"当前分页\"+that.page)\n\t\t\t\tthat.squareid = type;\n\t\t\t\tclearInterval(that.isGetChat);\n\t\t\t\tthat.isGetChat = null\n\t\t\t\tif(type==0){\r\n\t\t\t\t\tif(that.page == 1){\r\n\t\t\t\t\t\tthat.getSpaceList(false);\r\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(type==1){\n\t\t\t\t\tif(that.token!=\"\"){\n\t\t\t\t\t\tthat.getMyChat(false);\n\t\t\t\t\t\tthat.isGetChat = setInterval(() => {\n\t\t\t\t\t\t that.getMyChat(false);\n\t\t\t\t\t\t}, 4000);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tloadMore(){\n\t\t\t\tvar that = this;\n\t\t\t\tthat.moreText=\"正在加载中...\";\n\t\t\t\tthat.isLoad=1;\n\t\t\t\tif(that.squareid==0){\n\t\t\t\t\tthat.getSpaceList(true);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsearchClose(){\n\t\t\t\tvar that = this;\n\t\t\t\tthat.searchText = \"\";\n\t\t\t\tthat.page = 1;\n\t\t\t\tthat.getUserList(false);\n\t\t\t},\n\t\t\tformatDate(datetime) {\n\t\t\t\tvar datetime = new Date(parseInt(datetime * 1000));\n\t\t\t\t// 获取年月日时分秒值  slice(-2)过滤掉大于10日期前面的0\n\t\t\t\tvar year = datetime.getFullYear(),\n\t\t\t\t\tmonth = (\"0\" + (datetime.getMonth() + 1)).slice(-2),\n\t\t\t\t\tdate = (\"0\" + datetime.getDate()).slice(-2),\n\t\t\t\t\thour = (\"0\" + datetime.getHours()).slice(-2),\n\t\t\t\t\tminute = (\"0\" + datetime.getMinutes()).slice(-2);\n\t\t\t\t//second = (\"0\" + date.getSeconds()).slice(-2);\n\t\t\t\t// 拼接\n\t\t\t\tvar result = year + \"-\" + month + \"-\" + date + \" \" + hour + \":\" + minute;\n\t\t\t\t// 返回\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\ttoInfo(data){\n\t\t\t\tvar that = this;\n\t\t\t\tclearInterval(that.chatLoading);\n\t\t\t\tthat.chatLoading = null\n\t\t\t\tuni.navigateTo({\n\t\t\t\t    url: '/pages/contents/info?cid='+data.cid+\"&title=\"+data.title\n\t\t\t\t});\n\t\t\t},\n\t\t\ttoPage(title,cid){\n\t\t\t\tvar that = this;\n\t\t\t\tclearInterval(that.chatLoading);\n\t\t\t\tthat.chatLoading = null\n\t\t\t\tuni.navigateTo({\n\t\t\t\t    url: '/pages/contents/info?cid='+cid+\"&title=\"+title\n\t\t\t\t});\n\t\t\t},\n\t\t\ttoSearch(){\n\t\t\t\tvar that = this;\n\t\t\t\tif(that.noLogin){\n\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t    url: '/pages/user/login'\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tclearInterval(that.chatLoading);\n\t\t\t\tthat.chatLoading = null\n\t\t\t\tuni.navigateTo({\n\t\t\t\t    url: '/pages/contents/search'\n\t\t\t\t});\n\t\t\t},\n\t\t\tgoPage(url){\n\t\t\t\tvar that = this;\n\t\t\t\tclearInterval(that.chatLoading);\n\t\t\t\tthat.chatLoading = null\n\t\t\t\tuni.navigateTo({\n\t\t\t\t    url: url\n\t\t\t\t});\n\t\t\t},\n\t\t\ttoCategoryContents(title,id){\n\t\t\t\tvar that = this;\n\t\t\t\tclearInterval(that.chatLoading);\n\t\t\t\tthat.chatLoading = null\n\t\t\t\tvar type=\"meta\";\n\t\t\t\tuni.navigateTo({\n\t\t\t\t    url: '/pages/contents/contentlist?title='+title+\"&type=\"+type+\"&id=\"+id\n\t\t\t\t});\n\t\t\t},\n\t\t\tuserStatus() {\n\t\t\t\tvar that = this;\n\t\t\t\tthat.$Net.request({\n\t\t\t\t\t\n\t\t\t\t\turl: that.$API.userStatus(),\n\t\t\t\t\tdata:{\n\t\t\t\t\t\t\"token\":that.token\n\t\t\t\t\t},\n\t\t\t\t\theader:{\n\t\t\t\t\t\t'Content-Type':'application/x-www-form-urlencoded'\n\t\t\t\t\t},\n\t\t\t\t\tmethod: \"get\",\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tsuccess: function(res) {\n\t\t\t\t\t\tthat.isLoading=1;\n\t\t\t\t\t\tif(res.data.code==0){\n\t\t\t\t\t\t\tlocalStorage.removeItem('userinfo');\n\t\t\t\t\t\t\tlocalStorage.removeItem('token');\n\t\t\t\t\t\t\tthat.token = \"\";\n\t\t\t\t\t\t\tthat.userinfo = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfail: function(res) {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: \"网络开小差了哦\",\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\ttoLink(text){\n\t\t\t\tvar that = this;\n\t\t\t\t\n\t\t\t\tif(!localStorage.getItem('token')||localStorage.getItem('token')==\"\"){\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: \"请先登录哦\",\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: text\n\t\t\t\t});\n\t\t\t},\n\t\t\ttoGroup(){\n\t\t\t\tvar url = that.$API.GetGroupUrl();\n\t\t\t\t// #ifdef APP-PLUS\n\t\t\t\tplus.runtime.openURL(url) \n\t\t\t\t// #endif\n\t\t\t\t// #ifdef H5\n\t\t\t\twindow.open(url)\n\t\t\t\t// #endif\n\t\t\t},\n\t\t\tunreadNum() {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tif(localStorage.getItem('noticeSum')){\r\n\t\t\t\t\tthat.noticeSum = Number(localStorage.getItem('noticeSum'));\r\n\t\t\t\t}\r\n\t\t\t},\n\t\t\t\n\t\t\t//群聊(性能考虑，只加载前30条)\n\t\t\tgetMyChat(isPage){\n\t\t\t\tvar that = this;\n\t\t\t\tvar page = that.page;\n\t\t\t\tif(isPage){\n\t\t\t\t\tpage++;\n\t\t\t\t}\n\t\t\t\tif(that.token==\"\"){\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t    title:\"请先登录\",\n\t\t\t\t\t\ticon:'none',\n\t\t\t\t\t\tduration: 1000,\n\t\t\t\t\t\tposition:'bottom',\n\t\t\t\t\t});\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tthat.$Net.request({\n\t\t\t\t\turl: that.$API.allChat(),\n\t\t\t\t\tdata:{\n\t\t\t\t\t\t\"token\":that.token,\n\t\t\t\t\t\t\"limit\":30,\n\t\t\t\t\t\t\"page\":page,\n\t\t\t\t\t\t\"type\":that.type,\n\t\t\t\t\t\t\"order\":\"lastTime\"\n\t\t\t\t\t},\n\t\t\t\t\theader:{\n\t\t\t\t\t\t'Content-Type':'application/x-www-form-urlencoded'\n\t\t\t\t\t},\n\t\t\t\t\tmethod: \"get\",\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tsuccess: function(res) {\n\t\t\t\t\t\tthat.isLoading = 1;\n\t\t\t\t\t\tthat.isLoad=0;\n\t\t\t\t\t\tif(res.data.code==1){\n\t\t\t\t\t\t\tvar list = res.data.data;\n\t\t\t\t\t\t\tif(list.length>0){\n\t\t\t\t\t\t\t\tvar chatList = [];\n\t\t\t\t\t\t\t\tfor(var i in list){\n\t\t\t\t\t\t\t\t\tvar arr = list[i];\n\t\t\t\t\t\t\t\t\tarr.isNew =0;\n\t\t\t\t\t\t\t\t\tarr.unRead =0;\n\t\t\t\t\t\t\t\t\tchatList.push(arr);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(isPage){\n\t\t\t\t\t\t\t\t\tthat.page++;\n\t\t\t\t\t\t\t\t\tthat.chatList = that.chatList.concat(chatList);\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tvar oldChatList = [];\n\t\t\t\t\t\t\t\t\tif(that.oldChatList!=null){\n\t\t\t\t\t\t\t\t\t\toldChatList = that.oldChatList;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(oldChatList.length>0){\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif(!that.arraysEqual(oldChatList,chatList)){\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"开始对比\")\n\t\t\t\t\t\t\t\t\t\t\tfor(var c in chatList){\n\t\t\t\t\t\t\t\t\t\t\t\tfor(var d in oldChatList){\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(oldChatList[d].id == chatList[c].id){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(oldChatList[d].lastTime < chatList[c].lastTime){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"赋值完成\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchatList[c].isNew = 1;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar unRead = chatList[c].msgNum - oldChatList[d].msgNum;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(unRead <= 0){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunRead = 0;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchatList[c].unRead = unRead;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tthat.oldChatList = chatList;\n\t\t\t\t\t\t\t\t\t\t\tthat.chatList = chatList;\n\t\t\t\t\t\t\t\t\t\t\tlocalStorage.setItem('AllchatList',JSON.stringify(chatList));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tthat.oldChatList = chatList;\n\t\t\t\t\t\t\t\t\t\tthat.chatList = chatList;\n\t\t\t\t\t\t\t\t\t\tlocalStorage.setItem('AllchatList',JSON.stringify(chatList));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t// that.moreText=\"没有更多消息了\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfail: function(res) {\n\t\t\t\t\t\tthat.isLoading = 1;\n\t\t\t\t\t\tthat.isLoad=0;\n\t\t\t\t\t\t// that.moreText=\"加载更多\";\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tarraysEqual(a, b) {\n\t\t\t\tif (a === b) return true;\n\t\t\t\tif (a == null || b == null) return false;\n\t\t\t\tif (a.length != b.length) return false;\n\t\t\t\tfor(var c in a){\n\t\t\t\t\tfor(var d in b){\n\t\t\t\t\t\tif(b[d].id == a[c].id){\n\t\t\t\t\t\t\tif(b[d].lastTime != a[c].lastTime){\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tchatFormatDate(datetime) {\n\t\t\t\tvar datetime = new Date(parseInt(datetime * 1000));\n\t\t\t\t// 获取年月日时分秒值  slice(-2)过滤掉大于10日期前面的0\n\t\t\t\tvar year = datetime.getFullYear();\n\t\t\t\tvar month = (\"0\" + (datetime.getMonth() + 1)).slice(-2);\n\t\t\t\tvar date = (\"0\" + datetime.getDate()).slice(-2);\n\t\t\t\tvar hour = (\"0\" + datetime.getHours()).slice(-2);\n\t\t\t\tvar minute = (\"0\" + datetime.getMinutes()).slice(-2);\n\t\t\t\tvar time = year+\"\"+month+\"\"+date;\n\t\t\t\t\n\t\t\t\tvar result = hour + \":\" + minute;\n\t\t\t\tvar curDate = new Date();\n\t\t\t\tvar curYear = curDate.getFullYear(); //获取完整的年份(4位)\n\t\t\t\tvar curMonth = (\"0\" + (curDate.getMonth() + 1)).slice(-2);\n\t\t\t\tvar curDay = (\"0\" + curDate.getDate()).slice(-2); //获取当前日(1-31)\n\t\t\t\tvar curTime = curYear+\"\"+curMonth+\"\"+curDay;\n\t\t\t\tif(year==curYear){\n\t\t\t\t\tif(year==curYear){\n\t\t\t\t\t\tif(date==curDay){\n\t\t\t\t\t\t\tresult = hour + \":\" + minute;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tresult = month + \"-\" + date;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tresult = month + \"-\" + date;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tresult = month + \"-\" + date;\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\tgoChat(data){\n\t\t\t\tvar that = this;\n\t\t\t\tvar chatid = data.id;\n\t\t\t\tclearInterval(that.chatLoading);\n\t\t\t\tthat.chatLoading = null\n\t\t\t\t//去除未读标志\n\t\t\t\tvar chatlist = that.chatList;\n\t\t\t\tfor(var i in chatlist){\n\t\t\t\t\tif(chatlist[i].id==chatid){\n\t\t\t\t\t\tchatlist[i].isNew =0;\n\t\t\t\t\t\tchatlist[i].unRead =0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthat.chatList = chatlist;\n\t\t\t\tthat.oldChatList = that.chatList;\n\t\t\t\tlocalStorage.setItem('AllchatList',JSON.stringify(that.chatList));\n\t\t\t\t//结束\n\t\t\t\tif(data.type==0){\n\t\t\t\t\tvar name = data.userJson.name;\n\t\t\t\t\tvar uid = data.userJson.uid;\n\t\t\t\t\t\n\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t    url: '/pages/chat/chat?uid='+uid+\"&name=\"+name+\"&chatid=\"+chatid+\"&type=0\"\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif(data.type==1){\n\t\t\t\t\tvar name = data.name;\n\t\t\t\t\t\n\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t    url: '/pages/chat/chat?&name='+name+'&chatid='+chatid+'&type=1'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t},\n\t\t\tpostSpace(type){\n\t\t\t\tvar that = this;\n\t\t\t\tif(type==1){\n\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t    url: '/pages/edit/articlePost'\n\t\t\t\t\t});\n\t\t\t\t}else if(type==5){\n\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t    url: '/pages/edit/addshop'\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t    url: '/pages/space/post?type='+type\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t},\n\t\t\tgetSpaceList(isPage){\n\t\t\t\tvar that = this;\n\t\t\t\tvar page = that.page;\n\t\t\t\tif(isPage){\n\t\t\t\t\tpage++;\n\t\t\t\t}\n\t\t\t\tvar data = {\n\t\t\t\t\t\"status\":1\n\t\t\t\t}\n\t\t\t\tvar token = \"\";\n\t\t\t\tif(localStorage.getItem('userinfo')){\n\t\t\t\t\tvar userInfo = JSON.parse(localStorage.getItem('userinfo'));\n\t\t\t\t\ttoken=userInfo.token;\n\t\t\t\t\n\t\t\t\t}\n\t\t\t\tthat.$Net.request({\n\t\t\t\t\turl: that.$API.spaceList(),\n\t\t\t\t\tdata:{\n\t\t\t\t\t\t\"searchParams\":JSON.stringify(that.$API.removeObjectEmptyKey(data)),\n\t\t\t\t\t\t\"limit\":10,\n\t\t\t\t\t\t\"page\":page,\n\t\t\t\t\t\t\"order\":\"created\",\n\t\t\t\t\t\t\"token\":token\n\t\t\t\t\t},\n\t\t\t\t\tmethod: \"get\",\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tsuccess: function(res) {\n\t\t\t\t\t\tthat.isLoading = 1;\n\t\t\t\t\t\tthat.isLoad=0;\n\t\t\t\t\t\tthat.moreText=\"加载更多\";\n\t\t\t\t\t\tif(!isPage){\n\t\t\t\t\t\t\tthat.dataLoad = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(res.data.code==1){\n\t\t\t\t\t\t\tthat.noLogin = false;\n\t\t\t\t\t\t\tvar list = res.data.data;\n\t\t\t\t\t\t\tvar spaceList = [];\n\t\t\t\t\t\t\tfor(var i in list){\n\t\t\t\t\t\t\t\tif(list[i].type==0){\n\t\t\t\t\t\t\t\t\tif(list[i].pic){\n\t\t\t\t\t\t\t\t\t\tvar pic = list[i].pic;\n\t\t\t\t\t\t\t\t\t\tlist[i].picList = pic.split(\"||\");\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tlist[i].picList = [];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(list[i].type==2){\n\t\t\t\t\t\t\t\t\tif(list[i].forwardJson.pic){\n\t\t\t\t\t\t\t\t\t\tvar pic = list[i].forwardJson.pic;\n\t\t\t\t\t\t\t\t\t\tlist[i].forwardJson.picList = pic.split(\"||\");\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tlist[i].forwardJson.picList = [];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tspaceList = list;\n\t\t\t\t\t\t\tif(list.length>0){\n\t\t\t\t\t\t\t\tif(isPage){\n\t\t\t\t\t\t\t\t\tthat.page++;\n\t\t\t\t\t\t\t\t\tthat.spaceList = that.spaceList.concat(spaceList);\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tthat.spaceList = spaceList;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlocalStorage.setItem('spaceList',JSON.stringify(spaceList));\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tthat.moreText=\"没有更多动态了\";\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tif(res.data.msg==\"用户未登录或Token验证失败\"){\n\t\t\t\t\t\t\t\tthat.noLogin = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfail: function(res) {\n\t\t\t\t\t\tthat.isLoading = 1;\n\t\t\t\t\t\tthat.moreText=\"加载更多\";\n\t\t\t\t\t\tthat.isLoad=0;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\tgoUserInfo(){\n\t\t\t\t \n\t\t\t\tvar that = this;\n\t\t\t\tif(!localStorage.getItem('token')||localStorage.getItem('token')==\"\"){\n\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t    url: '/pages/user/login'\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tuni.switchTab({\n\t\t\t\t\turl: '/pages/home/user'\n\t\t\t\t});\n\t\t\t},\n\t\t\tgoLogin(){\n\t\t\t\tuni.navigateTo({\n\t\t\t\t    url: '/pages/user/login'\n\t\t\t\t});\n\t\t\t},\n\t\t\tgoRegister(){\n\t\t\t\tuni.navigateTo({\n\t\t\t\t    url: '/pages/user/register'\n\t\t\t\t});\n\t\t\t},\n\t\t\tsubText(text,num){\n\t\t\t\tif(text.length < null){\n\t\t\t\t\treturn text.substring(0,num)+\"……\"\n\t\t\t\t}else{\n\t\t\t\t\treturn text;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t},\n\t\t\tgoLogin(){\n\t\t\t\tuni.navigateTo({\n\t\t\t\t    url: '/pages/user/login'\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\t\t// #ifdef APP-PLUS\n\t\tcomponents: {\n\t\t\twaves\n\t\t},\n\t\t// #endif\n\t\t\n\t\t// #ifdef H5 || MP\n\t\tcomponents: {\n\t\t\twaves\n\t\t},\n\t\t// #endif\n\t\t\n\t}\n</script>\n\n<style>\n</style>\n"],"sourceRoot":""}