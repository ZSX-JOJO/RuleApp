(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user-usercomments"],{6460:function(t,e,n){"use strict";n("7a82");var i=n("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("99af"),n("e9c4"),n("14d9");var a=n("625a"),o=i(n("634b")),s={data:function(){return{StatusBar:this.StatusBar,CustomBar:this.CustomBar,NavBar:this.StatusBar+this.CustomBar,AppStyle:this.$store.state.AppStyle,commentsList:[],moreText:"加载更多",page:1,isLoading:0,owo:o.default,owoList:[],allowDelete:0}},onPullDownRefresh:function(){},onReachBottom:function(){this.loadMore()},onShow:function(){this.page=1},onLoad:function(){var t=this.owo.data,e=[];for(var n in t)e=e.concat(t[n].container);this.owoList=e,this.contentConfig(),this.getCommentsList(!1)},methods:{back:function(){uni.navigateBack({delta:1})},loadMore:function(){this.moreText="正在加载中...",0==this.isLoad&&this.getCommentsList(!0)},toInfo:function(t,e){uni.navigateTo({url:"/pages/contents/info?cid="+t+"&title="+e})},contentConfig:function(){var t=this;t.$Net.request({url:t.$API.contentConfig(),method:"get",dataType:"json",success:function(e){1==e.data.code&&(t.allowDelete=e.data.data.allowDelete)},fail:function(t){uni.showToast({title:"网络开小差了哦",icon:"none"})}})},getCommentsList:function(t){var e=this,n=null;if(!a.localStorage.getItem("userinfo"))return uni.showToast({title:"请先登录哦",icon:"none"}),!1;n=JSON.parse(a.localStorage.getItem("userinfo"));var i={type:"comment",authorId:n.uid},o=e.page;t&&o++,e.$Net.request({url:e.$API.getCommentsList(),data:{searchParams:JSON.stringify(e.$API.removeObjectEmptyKey(i)),limit:5,page:o},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(n){if(e.isLoad=0,1==n.data.code){var i=n.data.data;if(i.length>0){var a=[];for(var o in i){var s=i[o];s.style="background-image:url("+i[o].avatar+");",a.push(s)}t?(e.page++,e.commentsList=e.commentsList.concat(a)):e.commentsList=a}else e.moreText="没有更多评论了"}setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)},fail:function(t){e.isLoad=0,e.moreText="加载更多";setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)}})},toDelete:function(t){var e=this,n="";if(a.localStorage.getItem("userinfo")){var i=JSON.parse(a.localStorage.getItem("userinfo"));n=i.token}var o={key:t,token:n};uni.showModal({title:"确定要删除该评论吗",success:function(t){t.confirm?(uni.showLoading({title:"加载中"}),e.$Net.request({url:e.$API.commentsDelete(),data:o,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:t.data.msg,icon:"none"}),1==t.data.code&&e.getCommentsList()},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"})}})):t.cancel&&console.log("用户点击取消")}})}}};e.default=s},6940:function(t,e,n){"use strict";n.r(e);var i=n("6460"),a=n.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=a.a},7401:function(t,e,n){"use strict";n.r(e);var i=n("cb51"),a=n("6940");for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);var s=n("f0c5"),c=Object(s["a"])(a["default"],i["b"],i["c"],!1,null,"18191a48",null,!1,i["a"],void 0);e["default"]=c.exports},cb51:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"user",class:t.AppStyle},[i("v-uni-view",{staticClass:"header",style:[{height:t.CustomBar+"px"}]},[i("v-uni-view",{staticClass:"cu-bar bg-white",style:{height:t.CustomBar+"px","padding-top":t.StatusBar+"px"}},[i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-back"})],1),i("v-uni-view",{staticClass:"content text-bold",style:[{top:t.StatusBar+"px"}]},[t._v("我的评论")]),i("v-uni-view",{staticClass:"action"})],1)],1),i("v-uni-view",{style:[{padding:t.NavBar+"px 10px 0px 10px"}]}),i("v-uni-view",{staticClass:"cu-card dynamic no-card",staticStyle:{"margin-top":"20upx"}},[i("v-uni-view",{staticClass:"cu-item"},[i("v-uni-view",{staticClass:"cu-list menu-avatar comment"},[0==t.commentsList.length?i("v-uni-view",{staticClass:"no-data"},[t._v("暂时没有评论")]):t._e(),i("v-uni-view",{staticClass:"cu-card dynamic no-card",staticStyle:{"margin-top":"20upx"}},[t._l(t.commentsList,(function(e,n){return t.commentsList.length>0?[i("commentItem",{key:n+"_0",attrs:{item:e}})]:t._e()}))],2),t.commentsList.length>0?i("v-uni-view",{staticClass:"load-more",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.loadMore.apply(void 0,arguments)}}},[i("v-uni-text",[t._v(t._s(t.moreText))])],1):t._e()],1)],1)],1),0==t.isLoading?i("v-uni-view",{staticClass:"loading"},[i("v-uni-view",{staticClass:"loading-main"},[i("v-uni-image",{attrs:{src:n("14d6")}})],1)],1):t._e()],1)},a=[]}}]);