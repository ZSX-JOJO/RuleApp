(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-metasedit"],{"42af":function(t,e,i){"use strict";i.r(e);var a=i("9246"),n=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=n.a},9246:function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("e9c4"),i("a4d3"),i("e01a");var a=i("625a"),n={data:function(){return{StatusBar:this.StatusBar,CustomBar:this.CustomBar,NavBar:this.StatusBar+this.CustomBar,AppStyle:this.$store.state.AppStyle,mid:0,name:"",order:0,slug:"",imgurl:"",description:"",metaType:"category",type:"add",curMid:0,curName:"",parentList:[],modalName:null}},onPullDownRefresh:function(){},onShow:function(){},onLoad:function(t){t.type&&(this.type=t.type),t.mid?(this.mid=t.mid,this.geMetaInfo()):this.getMetaList()},methods:{back:function(){uni.navigateBack({delta:1})},midRadioChange:function(t){this.curMid=t.detail.value},showModal:function(t){this.modalName=t.currentTarget.dataset.target},hideModal:function(t){this.modalName=null},setMid:function(t){this.curMid=t;var e=this.parentList;for(var i in e)e[i].mid==this.curMid&&(this.curName=e[i].name);this.hideModal()},getMetaList:function(){var t=this;t.$Net.request({url:t.$API.getMetasList(),data:{searchParams:JSON.stringify(t.$API.removeObjectEmptyKey({type:"category",parent:0})),limit:50},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){if(1==e.data.code){var i=e.data.data;if(t.parentList=i,0!=t.curMid)for(var a in i)i[a].mid==t.curMid&&(t.curName=i[a].name)}setTimeout((function(){t.isLoading=1,clearTimeout("timer")}),300)},fail:function(t){uni.stopPullDownRefresh()}})},geMetaInfo:function(){var t=this;t.$Net.request({url:t.$API.geMetaInfo(),data:{key:t.mid},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){1==e.data.code&&(t.name=e.data.data.name,t.imgurl=e.data.data.imgurl,t.order=e.data.data.orderKey,t.description=e.data.data.description,t.slug=e.data.data.slug,t.curMid=e.data.data.parent,t.getMetaList())},fail:function(t){uni.showToast({title:"网络开小差了哦",icon:"none"})}})},metaEdit:function(){var t=this;if(""==t.name)return uni.showToast({title:"请输入名称",icon:"none",duration:1e3,position:"bottom"}),!1;var e="";if(a.localStorage.getItem("userinfo")){var i=JSON.parse(a.localStorage.getItem("userinfo"));e=i.token}var n={mid:t.mid,name:t.name,description:t.description,imgurl:t.imgurl,slug:t.slug,orderKey:t.order};"category"==t.metaType&&(n.parent=t.curMid),uni.showLoading({title:"加载中"}),t.$Net.request({url:t.$API.editMeta(),data:{params:JSON.stringify(t.$API.removeObjectEmptyKey(n)),token:e},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){if(setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:e.data.msg,icon:"none"}),1==e.data.code)setTimeout((function(){t.back(),clearTimeout("timer")}),1e3)},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"}),uni.stopPullDownRefresh()}})},metaAdd:function(){var t=this;if(""==t.name)return uni.showToast({title:"请输入名称",icon:"none",duration:1e3,position:"bottom"}),!1;var e="";if(a.localStorage.getItem("userinfo")){var i=JSON.parse(a.localStorage.getItem("userinfo"));e=i.token}var n={name:t.name,description:t.description,imgurl:t.imgurl,slug:t.slug,orderKey:t.order,type:t.metaType};"category"==t.metaType&&(n.parent=t.curMid),uni.showLoading({title:"加载中"}),t.$Net.request({url:t.$API.addMeta(),data:{params:JSON.stringify(t.$API.removeObjectEmptyKey(n)),token:e},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){if(setTimeout((function(){uni.hideLoading()}),1e3),1==e.data.code){uni.showToast({title:e.data.msg+"，请等待缓存生效",icon:"none"});setTimeout((function(){t.back(),clearTimeout("timer")}),1e3)}else uni.showToast({title:e.data.msg,icon:"none"})},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"}),uni.stopPullDownRefresh()}})},upload:function(){var t=this,e="";if(a.localStorage.getItem("userinfo")){var i=JSON.parse(a.localStorage.getItem("userinfo"));e=i.token}uni.chooseImage({count:1,sourceType:["album","camera"],success:function(i){uni.showLoading({title:"加载中"});for(var a=i.tempFilePaths,n=function(i){uni.uploadFile({url:t.$API.upload(),filePath:a[i],name:"file",formData:{token:e},success:function(e){i==a.length-1&&setTimeout((function(){uni.hideLoading()}),1e3);var n=JSON.parse(e.data);uni.showToast({title:n.msg,icon:"none"}),1==n.code&&(t.imgurl=n.data.url)},fail:function(){setTimeout((function(){uni.hideLoading()}),1e3)}})},o=0;o<a.length;o++)n(o)}})}}};e.default=n},a85b:function(t,e,i){"use strict";i.r(e);var a=i("c918"),n=i("42af");for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);var s=i("f0c5"),u=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"37f5f4dc",null,!1,a["a"],void 0);e["default"]=u.exports},c918:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"user",class:t.$store.state.AppStyle},[i("v-uni-view",{staticClass:"header",style:[{height:t.CustomBar+"px"}]},[i("v-uni-view",{staticClass:"cu-bar bg-white",style:{height:t.CustomBar+"px","padding-top":t.StatusBar+"px"}},[i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-back"})],1),i("v-uni-view",{staticClass:"content text-bold",style:[{top:t.StatusBar+"px"}]},["add"==t.type?[t._v("添加分类标签")]:[t._v("分类标签编辑")]],2),"edit"==t.type?i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.metaEdit.apply(void 0,arguments)}}},[i("v-uni-button",{staticClass:"cu-btn round bg-blue"},[t._v("保存")])],1):t._e(),"add"==t.type?i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.metaAdd.apply(void 0,arguments)}}},[i("v-uni-button",{staticClass:"cu-btn round bg-blue"},[t._v("提交")])],1):t._e()],1)],1),i("v-uni-view",{style:[{padding:t.NavBar+"px 10px 0px 10px"}]}),i("v-uni-form",["edit"==t.type?i("v-uni-view",{staticClass:"cu-form-group margin-top"},[i("v-uni-view",{staticClass:"title"},[t._v("MID")]),i("v-uni-input",{attrs:{name:"input",disabled:!0,value:t.mid}})],1):t._e(),i("v-uni-view",{staticClass:"cu-form-group margin-top"},[i("v-uni-view",{staticClass:"title"},[t._v("名称")]),i("v-uni-input",{attrs:{name:"input",type:"text"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),i("v-uni-view",{staticClass:"cu-form-group margin-top"},[i("v-uni-view",{staticClass:"title"},[t._v("缩略名")]),i("v-uni-input",{attrs:{name:"input",type:"text",placeholder:"用于url生成,建议英文"},model:{value:t.slug,callback:function(e){t.slug=e},expression:"slug"}})],1),"add"==t.type?i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("类型")]),i("v-uni-view",{staticClass:"action"},[i("v-uni-text",{staticClass:"meta-type",class:"category"==t.metaType?"act":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.metaType="category"}}},[t._v("分类")]),i("v-uni-text",{staticClass:"meta-type",class:"tag"==t.metaType?"act":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.metaType="tag"}}},[t._v("标签")])],1)],1):t._e(),"category"==t.metaType?i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("上级分类")]),i("v-uni-view",{staticClass:"action",attrs:{"data-target":"parentList"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showModal.apply(void 0,arguments)}}},[0==t.curMid?i("v-uni-text",{staticClass:"text-blue"},[t._v("选择分类")]):i("v-uni-text",{staticClass:"text-blue"},[t._v(t._s(t.curName))])],1)],1):t._e(),i("v-uni-view",{staticClass:"cu-form-group align-start"},[i("v-uni-view",{staticClass:"title"},[t._v("简介")]),i("v-uni-textarea",{attrs:{placeholder:"请输入分类和标签简介"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1),i("v-uni-view",{staticClass:"cu-form-group margin-top"},[i("v-uni-view",{staticClass:"title"},[t._v("排序")]),i("v-uni-input",{attrs:{name:"input",type:"number",placeholder:"数值越大,排序越高"},model:{value:t.order,callback:function(e){t.order=e},expression:"order"}})],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("缩略图")]),i("v-uni-view",{staticClass:"action"},[i("v-uni-text",{staticClass:"cu-btn bg-blue radius",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.upload.apply(void 0,arguments)}}},[t._v("上传图片")])],1)],1),""!=t.imgurl?i("v-uni-view",{staticClass:"pay-codeImg"},[i("v-uni-image",{attrs:{src:t.imgurl}})],1):t._e()],1),i("v-uni-view",{staticClass:"cu-modal",class:"parentList"==t.modalName?"show":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideModal.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"cu-dialog",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}}},[i("v-uni-radio-group",{staticClass:"block",on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.midRadioChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"cu-list menu text-left"},t._l(t.parentList,(function(e,a){return i("v-uni-view",{key:a,staticClass:"cu-item"},[i("v-uni-label",{staticClass:"flex justify-between align-center flex-sub",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.setMid(e.mid)}}},[i("v-uni-view",{staticClass:"flex-sub"},[t._v(t._s(e.name))]),i("v-uni-radio",{staticClass:"round",class:t.curMid==e.mid?"checked":"",attrs:{checked:t.curMid==e.mid}})],1)],1)})),1)],1)],1)],1)],1)},n=[]}}]);