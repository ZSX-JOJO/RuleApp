(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-space-post"],{"13e5":function(t,e,i){"use strict";i.r(e);var n=i("6305"),o=i("52e4");for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);var s=i("f0c5"),c=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,"7cc24af8",null,!1,n["a"],void 0);e["default"]=c.exports},"1f8c":function(t,e,i){"use strict";i("7a82");var n=i("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("ac1f"),i("1276"),i("5319"),i("5b81"),i("c975"),i("14d9");var o=i("625a"),a=n(i("634b")),s={data:function(){return{StatusBar:this.StatusBar,CustomBar:this.CustomBar,NavBar:this.StatusBar+this.CustomBar,AppStyle:this.$store.state.AppStyle,id:0,postType:"add",type:0,text:"",toid:0,pic:"",picList:[],token:"",currencyName:"",forwardJson:null,contentJson:null,postJson:null,shopJson:null,isOwO:!1,owo:a.default,owoList:[],OwOtype:"paopao",modalName:null,kaptchaUrl:"",verifyCode:"",verifyLevel:0,onlyMe:!1}},onPullDownRefresh:function(){},onHide:function(){o.localStorage.removeItem("getuid")},onShow:function(){o.localStorage.getItem("token")&&(this.token=o.localStorage.getItem("token"))},onLoad:function(t){this.currencyName=this.$API.getCurrencyName(),this.owoList=this.owo.data.paopao.container,t.type&&(this.type=t.type),t.toid&&(this.toid=t.toid,6==this.type?this.getPostInfo():this.getInfo()),t.postType&&(this.postType=t.postType),t.id&&(this.id=t.id,"add"==this.postType?this.getForwardInfo(this.id):this.getSpaceInfo()),this.getConfig()},methods:{back:function(){uni.navigateBack({delta:1})},OnlyMe:function(t){this.onlyMe=t.detail.value},reloadCode:function(){var t=this.$API.getKaptcha(),e=Math.ceil(10*Math.random());t+="?"+e,this.kaptchaUrl=t},getConfig:function(){if(o.localStorage.getItem("AppInfo"))try{var t=JSON.parse(o.localStorage.getItem("AppInfo"));this.verifyLevel=t.verifyLevel}catch(e){console.log(e)}},hideModal:function(t){this.modalName=null},toOwO:function(t){this.OwOtype=t,"paopao"==t&&(this.owoList=this.owo.data.paopao.container),"adai"==t&&(this.owoList=this.owo.data.adai.container),"alu"==t&&(this.owoList=this.owo.data.alu.container),"quyinniang"==t&&(this.owoList=this.owo.data.quyinniang.container)},setOwO:function(t){var e=t.data;this.text+=e,this.isOwO=!1},OwO:function(){this.isOwO=!this.isOwO},getForwardInfo:function(t){var e=this,i="";if(o.localStorage.getItem("userinfo")){var n=JSON.parse(o.localStorage.getItem("userinfo"));i=n.token}var a={id:e.id,token:i};e.$Net.request({url:e.$API.spaceInfo(),data:a,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){e.isLoading=1,1==t.data.code&&(e.forwardJson=t.data.data,e.toid=t.data.data.id)},fail:function(t){e.isLoading=1}})},replaceAll:function(t,e,i){return t.split(e).join(i)},getSpaceInfo:function(){var t=this,e="";if(o.localStorage.getItem("userinfo")){var i=JSON.parse(o.localStorage.getItem("userinfo"));e=i.token}var n={id:t.id,token:e};t.$Net.request({url:t.$API.spaceInfo(),data:n,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){if(t.isLoading=1,1==e.data.code){t.id=e.data.data.id,t.type=e.data.data.type,1==e.data.data.onlyMe&&(t.onlyMe=!0);var i=e.data.data.text;i=t.replaceAll(i,"/r/n","\n"),i=t.replaceAll(i,"||rn||","\n"),t.text=i,t.toid=e.data.data.toid,e.data.data.pic&&(t.pic=e.data.data.pic,0==t.type&&(-1!=t.pic.indexOf("||")?t.picList=t.pic.split("||"):t.picList=t.picList.push(t.pic))),1==t.type&&(t.contentJson=e.data.data.contentJson),5==t.type&&(t.shopJson=e.data.data.shopJson),2==t.type&&t.getForwardInfo(t.toid)}},fail:function(e){t.isLoading=1}})},getInfo:function(){var t=this,e={key:t.toid,isMd:0};t.$Net.request({url:t.$API.getContentsInfo(),data:e,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){uni.stopPullDownRefresh(),e.data.title&&(t.contentJson=e.data)},fail:function(t){uni.stopPullDownRefresh()}})},getPostInfo:function(){var t=this,e={id:t.toid};t.$Net.request({url:t.$API.postInfoForum(),data:e,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"post",dataType:"json",success:function(e){uni.stopPullDownRefresh(),1==e.data.code&&(t.postJson=e.data.data)},fail:function(t){uni.stopPullDownRefresh()}})},addSpace:function(){var t=this;if(""==t.token){uni.showToast({title:"请先登录",icon:"none",duration:1e3,position:"bottom"});setTimeout((function(){uni.navigateTo({url:"/pages/user/login"}),clearTimeout("timer")}),1e3);return!1}if(2==t.type&&""==t.text&&(e="转发了动态"),""==t.text)return uni.showToast({title:"请输入动态内容",icon:"none",duration:1e3,position:"bottom"}),!1;var e=t.text;if(0==t.type){var i=t.picList,n="";for(var o in i)n+=0==o?i[o]:"||"+i[o];t.pic=n}if(4==t.type&&""==t.pic)return uni.showToast({title:"请上传视频文件",icon:"none",duration:1e3,position:"bottom"}),!1;e=e.replace(/\r\n/g,"||rn||"),e=e.replace(/\n/g,"||rn||");var a={type:t.type,text:e,toid:t.toid,pic:t.pic,token:t.token,verifyCode:t.verifyCode};t.onlyMe&&(a.onlyMe=1),uni.showLoading({title:"加载中"}),t.$Net.request({url:t.$API.addSpace(),data:t.$API.removeObjectEmptyKey(a),header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){if(t.modalName=null,t.verifyCode="",setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:e.data.msg,icon:"none"}),1==e.data.code)setTimeout((function(){t.back()}),1e3)},fail:function(e){t.modalName=null,t.verifyCode="",setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"}),uni.stopPullDownRefresh()}})},editSpace:function(){var t=this;if(""==t.token){uni.showToast({title:"请先登录",icon:"none",duration:1e3,position:"bottom"});setTimeout((function(){uni.navigateTo({url:"/pages/user/login"}),clearTimeout("timer")}),1e3);return!1}if(2==t.type&&""==t.text&&(e="转发了动态"),""==t.text)return uni.showToast({title:"请输入动态内容",icon:"none",duration:1e3,position:"bottom"}),!1;var e=t.text;if(0==t.type){var i=t.picList,n="";for(var o in i)n+=0==o?i[o]:"||"+i[o];t.pic=n}if(4==t.type&&""==t.pic)return uni.showToast({title:"请上传视频文件",icon:"none",duration:1e3,position:"bottom"}),!1;e=e.replace(/\r\n/g,"||rn||"),e=e.replace(/\n/g,"||rn||");var a={id:t.id,type:t.type,text:e,toid:t.toid,pic:t.pic,token:t.token};t.onlyMe&&(a.onlyMe=1),uni.showLoading({title:"加载中"}),t.$Net.request({url:t.$API.editSpace(),data:t.$API.removeObjectEmptyKey(a),header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){if(setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:e.data.msg,icon:"none"}),1==e.data.code)setTimeout((function(){t.back()}),1e3)},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"}),uni.stopPullDownRefresh()}})},upload:function(){var t=this;uni.chooseImage({count:9,sizeType:["original"],sourceType:["album","camera"],success:function(e){uni.showLoading({title:"加载中"});for(var i=e.tempFilePaths,n=0;n<i.length;n++)uni.uploadFile({url:t.$API.upload(),filePath:i[n],name:"file",formData:{token:t.token},success:function(e){1==i.length&&setTimeout((function(){uni.hideLoading()}),1e3);var n=JSON.parse(e.data);if(uni.showToast({title:n.msg,icon:"none"}),1==n.code){var o=n.data.url;t.picList.push(o)}},fail:function(){setTimeout((function(){uni.hideLoading()}),1e3)}})}})},uploadVideo:function(){var t=this;uni.chooseVideo({sourceType:["camera","album"],compressed:!1,success:function(e){uni.showLoading({title:"加载中"});var i=e.tempFilePath;uni.uploadFile({url:t.$API.upload(),filePath:i,name:"file",formData:{token:t.token},success:function(e){setTimeout((function(){uni.hideLoading()}),1e3);var i=JSON.parse(e.data);if(uni.showToast({title:i.msg,icon:"none"}),1==i.code){var n=i.data.url;t.pic=n}},fail:function(){uni.showToast({title:"网络异常，上传失败！",icon:"none"}),setTimeout((function(){uni.hideLoading()}),1e3)}})}})},picClose:function(t){var e=this.picList,i=[];for(var n in e)e[n]!=t&&i.push(e[n]);this.picList=i}}};e.default=s},"52e4":function(t,e,i){"use strict";i.r(e);var n=i("1f8c"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},6305:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"user",class:t.$store.state.AppStyle},[i("v-uni-view",{staticClass:"header",style:[{height:t.CustomBar+"px"}]},[i("v-uni-view",{staticClass:"cu-bar bg-white",style:{height:t.CustomBar+"px","padding-top":t.StatusBar+"px"}},[i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-back"})],1),i("v-uni-view",{staticClass:"content text-bold",style:[{top:t.StatusBar+"px"}]},["add"==t.postType?[0==t.type?[t._v("发布新动态")]:t._e(),1==t.type?[t._v("转发文章")]:t._e(),2==t.type?[t._v("转发动态")]:t._e(),4==t.type?[t._v("发布视频动态")]:t._e(),5==t.type?[t._v("转发商品")]:t._e(),6==t.type?[t._v("转发帖子")]:t._e()]:[t._v("编辑动态")]],2),i("v-uni-view",{staticClass:"action"},["add"==t.postType?[i("v-uni-button",{staticClass:"cu-btn round bg-gradual-orange",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.addSpace()}}},[t._v("发布")])]:[i("v-uni-button",{staticClass:"cu-btn round bg-gradual-orange",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.editSpace()}}},[t._v("保存")])]],2)],1)],1),i("v-uni-view",{style:[{padding:t.NavBar+"px 10px 0px 10px"}]}),i("v-uni-form",[i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-textarea",{attrs:{maxlength:"-1",placeholder:"输入您现在的想法"},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),i("v-uni-view",{staticClass:"comments-owo space-owo"},[i("v-uni-text",{staticClass:"cuIcon-emoji",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.OwO.apply(void 0,arguments)}}}),t.isOwO?i("v-uni-view",{staticClass:"owo"},[i("v-uni-scroll-view",{staticClass:"owo-list",attrs:{"scroll-y":!0}},[i("v-uni-view",{staticClass:"owo-main"},t._l(t.owoList,(function(e,n){return i("v-uni-view",{key:n,staticClass:"owo-lit-box",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.setOwO(e)}}},[i("v-uni-image",{attrs:{src:"/"+e.icon,mode:"aspectFill"}})],1)})),1)],1),i("v-uni-view",{staticClass:"owo-type"},[i("v-uni-view",{staticClass:"owo-box",class:"paopao"==t.OwOtype?"cur":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toOwO("paopao")}}},[t._v("泡泡")]),i("v-uni-view",{staticClass:"owo-box",class:"adai"==t.OwOtype?"cur":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toOwO("adai")}}},[t._v("阿呆")]),i("v-uni-view",{staticClass:"owo-box",class:"alu"==t.OwOtype?"cur":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toOwO("alu")}}},[t._v("阿鲁")]),i("v-uni-view",{staticClass:"owo-box",class:"quyinniang"==t.OwOtype?"cur":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toOwO("quyinniang")}}},[t._v("蛆音娘")])],1)],1):t._e()],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("仅自己可见")]),i("v-uni-switch",{class:t.onlyMe?"checked":"",attrs:{checked:!!t.onlyMe},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.OnlyMe.apply(void 0,arguments)}}})],1),0==t.type?[i("v-uni-view",{staticClass:"grid flex-sub col-3 grid-square space-pic"},[t._l(t.picList,(function(e,n){return i("v-uni-view",{key:n,staticClass:"bg-img",style:"background-image:url("+e+");"},[i("v-uni-text",{staticClass:"cuIcon-close",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.picClose(e)}}})],1)})),t.picList.length<9?i("v-uni-view",{staticClass:"space-upload",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.upload.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-add"})],1):t._e()],2)]:t._e(),4==t.type?[i("v-uni-view",{staticClass:"grid flex-sub col-3 grid-square space-pic"},[""==t.pic?i("v-uni-view",{staticClass:"space-upload",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadVideo.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-add"})],1):t._e(),""!=t.pic?i("v-uni-view",{staticClass:"space-upload "},[i("v-uni-text",{staticClass:"cuIcon-close bg-black",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.pic=""}}})],1):t._e()],1)]:t._e(),2==t.type?[null!=t.forwardJson?i("v-uni-view",{staticClass:"grid flex-sub padding-sm bg-white"},[i("v-uni-view",{staticClass:"user-space-info"},[i("v-uni-view",{staticClass:"user-space-text"},[i("v-uni-text",{staticClass:"text-blue"},[t._v("@"+t._s(t.forwardJson.userJson.name)+"：")]),t._v(t._s(t.forwardJson.text))],1)],1)],1):t._e()]:t._e(),1==t.type?[null!=t.contentJson&&0!=t.contentJson.cid?i("v-uni-view",{staticClass:"grid flex-sub padding-lr margin-top-sm"},[i("v-uni-view",{staticClass:"user-post-info"},[t.contentJson.images.length>0?i("v-uni-view",{staticClass:"user-post-pic"},[i("v-uni-image",{attrs:{src:t.contentJson.images[0],mode:"widthFix"}})],1):t._e(),i("v-uni-view",{staticClass:"user-post-text"},[i("v-uni-view",{staticClass:"user-post-title"},[t._v(t._s(t.contentJson.title))]),i("v-uni-view",{staticClass:"user-post-intro"},[t._v(t._s(t.contentJson.text))])],1)],1)],1):t._e()]:t._e(),5==t.type?[null!=t.shopJson&&0!=t.shopJson.id?i("v-uni-view",{staticClass:"grid flex-sub padding-lr"},[i("v-uni-view",{staticClass:"user-post-info"},[i("v-uni-view",{staticClass:"user-post-pic"},[i("v-uni-image",{attrs:{src:t.shopJson.imgurl,mode:"widthFix"}})],1),i("v-uni-view",{staticClass:"user-post-text"},[i("v-uni-view",{staticClass:"user-post-title"},[t._v(t._s(t.shopJson.title))]),i("v-uni-view",{staticClass:"user-post-intro"},[i("v-uni-text",{staticClass:"text-red text-lg text-bold"},[t._v(t._s(parseInt(t.shopJson.price))+" "+t._s(t.currencyName))])],1),i("v-uni-view",{staticClass:"user-post-intro"},[i("v-uni-text",{staticClass:"text-gray text-sm"},[t._v("剩余数量："+t._s(t.shopJson.num))])],1)],1)],1)],1):t._e()]:t._e()],2),i("v-uni-view",{staticClass:"cu-modal",class:"kaptcha"==t.modalName?"show":""},[i("v-uni-view",{staticClass:"cu-dialog kaptcha-dialog"},[i("v-uni-view",{staticClass:"cu-bar bg-white justify-end"},[i("v-uni-view",{staticClass:"content"},[t._v("操作验证")]),i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideModal.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-close"})],1)],1),i("v-uni-view",{staticClass:"kaptcha-form"},[i("v-uni-view",{staticClass:"kaptcha-image"},[i("v-uni-image",{attrs:{src:t.kaptchaUrl,mode:"widthFix"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.reloadCode()}}})],1),i("v-uni-view",{staticClass:"kaptcha-input"},[i("v-uni-input",{attrs:{name:"input",placeholder:"请输入验证码"},model:{value:t.verifyCode,callback:function(e){t.verifyCode=e},expression:"verifyCode"}}),i("v-uni-view",{staticClass:"cu-btn bg-blue",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.addSpace.apply(void 0,arguments)}}},[t._v("确定")])],1)],1)],1)],1)],1)},o=[]}}]);