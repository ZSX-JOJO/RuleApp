(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-tokenpay"],{"0d74":function(t,e,i){"use strict";i.r(e);var n=i("7c5f"),a=i.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=a.a},7057:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{class:t.AppStyle},[n("v-uni-view",{staticClass:"header",style:[{height:t.CustomBar+"px"}]},[n("v-uni-view",{staticClass:"cu-bar bg-white",style:{height:t.CustomBar+"px","padding-top":t.StatusBar+"px"}},[n("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"cuIcon-back"})],1),n("v-uni-view",{staticClass:"content text-bold",style:[{top:t.StatusBar+"px"}]},[t._v("卡密管理")]),n("v-uni-view",{staticClass:"action"},[n("v-uni-text",{staticClass:"cu-btn bg-green radius",attrs:{"data-target":"tokenExcel"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showModal.apply(void 0,arguments)}}},[t._v("导出")]),n("v-uni-text",{staticClass:"cu-btn bg-blue radius margin-left-sm",attrs:{"data-target":"tokenModal"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showModal.apply(void 0,arguments)}}},[t._v("生成")])],1)],1)],1),n("v-uni-view",{style:[{padding:t.NavBar+"px 10px 0px 10px"}]}),n("v-uni-view",{staticClass:"data-box"},[n("v-uni-view",{staticClass:"cu-bar bg-white search"},[n("v-uni-view",{staticClass:"search-form round"},[n("v-uni-text",{staticClass:"cuIcon-search"}),n("v-uni-input",{attrs:{type:"text",placeholder:"搜索Key或使用者UID"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.searchTag.apply(void 0,arguments)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),""!=t.searchText?n("v-uni-view",{staticClass:"search-close",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.searchClose()}}},[n("v-uni-text",{staticClass:"cuIcon-close"})],1):t._e()],1)],1),n("v-uni-view",{staticClass:"search-type grid col-2"},[n("v-uni-view",{staticClass:"search-type-box",class:0==t.status?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toType(0)}}},[n("v-uni-text",[t._v("未使用")])],1),n("v-uni-view",{staticClass:"search-type-box",class:1==t.status?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toType(1)}}},[n("v-uni-text",[t._v("已使用")])],1)],1),0==t.tokenList.length?n("v-uni-view",{staticClass:"no-data"},[n("v-uni-text",{staticClass:"cuIcon-text"}),t._v("暂时没有数据")],1):t._e(),t._l(t.tokenList,(function(e,i){return n("v-uni-view",{key:i,staticClass:"cu-item tokenList-box"},[n("v-uni-view",{staticClass:"content"},[n("v-uni-text",{staticClass:"text-bold"},[t._v(t._s(e.value))])],1),n("v-uni-view",{staticClass:"tokenList-info"},[n("v-uni-text",{staticClass:"tokenDate"},[t._v(t._s(t.formatDate(e.created)))]),0==e.status?n("v-uni-text",{staticClass:"cu-btn text-blue",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.ToCopy(e.value)}}},[t._v("复制")]):n("v-uni-text",{staticClass:"cu-btn bg-white"},[t._v("UID:"+t._s(e.uid))])],1)],1)})),t.tokenList.length>0?n("v-uni-view",{staticClass:"load-more",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.loadMore.apply(void 0,arguments)}}},[n("v-uni-text",[t._v(t._s(t.moreText))])],1):t._e()],2),n("v-uni-view",{staticClass:"cu-modal LinksModal",class:"tokenModal"==t.modalName?"show":""},[n("v-uni-view",{staticClass:"cu-dialog"},[n("v-uni-view",{staticClass:"cu-bar bg-white justify-end"},[n("v-uni-view",{staticClass:"content"},[t._v("生成充值码")]),n("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideModal.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"cuIcon-close text-red"})],1)],1),n("v-uni-view",{staticClass:"padding-xl"},[n("v-uni-input",{attrs:{placeholder:"充值码数量,一次最大100",type:"number"},model:{value:t.num,callback:function(e){t.num=e},expression:"num"}}),n("v-uni-input",{attrs:{placeholder:"充值码等同积分",type:"number"},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1),n("v-uni-view",{staticClass:"cu-bar bg-white justify-end"},[n("v-uni-view",{staticClass:"action"},[n("v-uni-button",{staticClass:"cu-btn line-blue text-blue",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideModal.apply(void 0,arguments)}}},[t._v("取消")]),n("v-uni-button",{staticClass:"cu-btn bg-blue margin-left",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toMade.apply(void 0,arguments)}}},[t._v("确定")])],1)],1)],1)],1),n("v-uni-view",{staticClass:"cu-modal LinksModal",class:"tokenExcel"==t.modalName?"show":""},[n("v-uni-view",{staticClass:"cu-dialog"},[n("v-uni-view",{staticClass:"cu-bar bg-white justify-end"},[n("v-uni-view",{staticClass:"content"},[t._v("导出充值码")]),n("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideModal.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"cuIcon-close text-red"})],1)],1),n("v-uni-view",{staticClass:"padding-xl"},[n("v-uni-text",{staticClass:"text-red"},[t._v("将导出未使用的充值码为Excel表格，填入过多条数可能导致数据库卡顿")]),n("v-uni-input",{attrs:{placeholder:"导出条数",type:"number"},model:{value:t.tokenNum,callback:function(e){t.tokenNum=e},expression:"tokenNum"}})],1),n("v-uni-view",{staticClass:"cu-bar bg-white justify-end"},[n("v-uni-view",{staticClass:"action"},[n("v-uni-button",{staticClass:"cu-btn line-blue text-blue",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideModal.apply(void 0,arguments)}}},[t._v("取消")]),n("v-uni-button",{staticClass:"cu-btn bg-blue margin-left",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toExcel.apply(void 0,arguments)}}},[t._v("确定")])],1)],1)],1)],1),0==t.isLoading?n("v-uni-view",{staticClass:"loading"},[n("v-uni-view",{staticClass:"loading-main"},[n("v-uni-image",{attrs:{src:i("14d6")}})],1)],1):t._e()],1)},a=[]},"7c5f":function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("e9c4"),i("99af"),i("e25e"),i("fb6a");var n=i("625a"),a={data:function(){return{StatusBar:this.StatusBar,CustomBar:this.CustomBar,NavBar:this.StatusBar+this.CustomBar,AppStyle:this.$store.state.AppStyle,tokenList:[],page:1,moreText:"加载更多",isLoad:0,searchText:"",isLoading:0,status:0,token:"",price:"",num:"",modalName:"",tokenNum:""}},onPullDownRefresh:function(){},onReachBottom:function(){this.loadMore()},onHide:function(){n.localStorage.removeItem("getuid")},onShow:function(){this.getTokenList()},onLoad:function(){},methods:{back:function(){uni.navigateBack({delta:1})},toType:function(t){this.status=t,this.tokenList=[],this.page=1,this.getTokenList()},loadMore:function(){this.moreText="正在加载中...",0==this.isLoad&&this.getTokenList(!0)},showModal:function(t){this.modalName=t.currentTarget.dataset.target},hideModal:function(){this.modalName=null},toMade:function(){var t=this;if(""==t.num||""==t.price)return uni.showToast({title:"请输入正确的参数",icon:"none",duration:1e3,position:"bottom"}),!1;var e="";if(n.localStorage.getItem("userinfo")){var i=JSON.parse(n.localStorage.getItem("userinfo"));e=i.token}var a={num:t.num,price:t.price,token:e};uni.showLoading({title:"加载中"}),t.$Net.request({url:t.$API.madetoken(),data:a,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){console.log(JSON.stringify(e)),setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:e.data.msg,icon:"none",duration:1e3,position:"bottom"}),1==e.data.code&&(t.status=0,t.tokenList=[],t.page=1,t.getTokenList(),t.hideModal())},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"}),uni.stopPullDownRefresh()}})},searchTag:function(){this.searchText;this.page=1,this.getTokenList()},searchClose:function(){this.searchText="",this.page=1,this.getTokenList()},getTokenList:function(t){var e=this,i=e.page,a="";if(n.localStorage.getItem("userinfo")){var s=JSON.parse(n.localStorage.getItem("userinfo"));a=s.token}var o={status:e.status};t&&i++,e.$Net.request({url:e.$API.tokenPayList(),data:{searchParams:JSON.stringify(e.$API.removeObjectEmptyKey(o)),limit:20,page:i,searchKey:e.searchText,order:"created",token:a},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(i){if(e.isLoad=0,1==i.data.code){var n=i.data.data;if(n.length>0){var a=n;t?(e.page++,e.tokenList=e.tokenList.concat(a)):e.tokenList=a}else e.moreText="没有更多数据了"}setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)},fail:function(t){e.isLoad=0,e.moreText="加载更多";setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)}})},formatDate:function(t){t=new Date(parseInt(1e3*t));var e=t.getFullYear(),i=("0"+(t.getMonth()+1)).slice(-2),n=("0"+t.getDate()).slice(-2),a=("0"+t.getHours()).slice(-2),s=("0"+t.getMinutes()).slice(-2),o=e+"-"+i+"-"+n+" "+a+":"+s;return o},ToCopy:function(t){uni.showToast({title:"复制成功"});var e=document.createElement("textarea");e.value=t,e.readOnly="readOnly",document.body.appendChild(e),e.select(),e.setSelectionRange(0,t.length);document.execCommand("copy");e.remove()},toExcel:function(){var t="";if(""==this.tokenNum||this.tokenNum<1)return uni.showToast({title:"请输入正确的条数",icon:"none",duration:1e3,position:"bottom"}),!1;if(!n.localStorage.getItem("userinfo"))return uni.showToast({title:"请先登录",icon:"none",duration:1e3,position:"bottom"}),!1;var e=JSON.parse(n.localStorage.getItem("userinfo"));t=e.token;var i=this.$API.tokenPayExcel()+"?limit="+this.tokenNum+"&token="+t;window.open(i)}}};e.default=a},"904b":function(t,e,i){"use strict";i.r(e);var n=i("7057"),a=i("0d74");for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);var o=i("f0c5"),c=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"3813c0bf",null,!1,n["a"],void 0);e["default"]=c.exports}}]);