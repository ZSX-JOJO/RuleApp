(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-metas"],{6336:function(t,e,i){"use strict";i.r(e);var a=i("93a1"),n=i.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},"6a22":function(t,e,i){"use strict";i.r(e);var a=i("d065"),n=i("6336");for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);var o=i("f0c5"),c=Object(o["a"])(n["default"],a["b"],a["c"],!1,null,"c5a53a98",null,!1,a["a"],void 0);e["default"]=c.exports},"93a1":function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("e9c4"),i("99af");var a=i("625a"),n={data:function(){return{StatusBar:this.StatusBar,CustomBar:this.CustomBar,NavBar:this.StatusBar+this.CustomBar,AppStyle:this.$store.state.AppStyle,metaList:[],searchText:"",type:"category",page:1,moreText:"加载更多",isLoad:0,token:"",isLoading:0}},onPullDownRefresh:function(){this.page=1,this.getMetaList(!1);setTimeout((function(){uni.stopPullDownRefresh()}),1e3)},onReachBottom:function(){0==this.isLoad&&this.loadMore()},onLoad:function(){},onShow:function(){this.getMetaList(!1),this.page=1},methods:{loadMore:function(){this.moreText="正在加载中...",this.isLoad=1,this.getMetaList(!0)},back:function(){uni.navigateBack({delta:1})},toType:function(t){this.type=t,this.page=1,this.metaList=[],this.moreText="加载更多",this.isLoad=0,this.getMetaList(!1)},getMetaList:function(t){var e=this,i={type:e.type};"category"==e.type&&(i.parent=0);var a=e.page;t&&a++,e.$Net.request({url:e.$API.getMetasList(),data:{searchParams:JSON.stringify(e.$API.removeObjectEmptyKey(i)),limit:8,page:a,searchKey:e.searchText,token:e.token},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(i){if(uni.stopPullDownRefresh(),e.isLoad=0,e.moreText="加载更多",1==i.data.code){var a=i.data.data;for(var n in a)a[n].subList=[];a.length>0?t?(e.page++,e.metaList=e.metaList.concat(a)):e.metaList=a:(e.moreText="没有更多内容了",t||(e.metaList=a))}setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)},fail:function(t){uni.stopPullDownRefresh(),e.moreText="加载更多",e.isLoad=0;setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)}})},getSubList:function(t){var e=this,i={type:e.type,parent:t};uni.showLoading({title:"加载中"}),e.$Net.request({url:e.$API.getMetasList(),data:{searchParams:JSON.stringify(e.$API.removeObjectEmptyKey(i)),limit:50,searchKey:e.searchText,token:e.token},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(i){if(uni.hideLoading(),1==i.data.code){var a=i.data.data;if(a.length>0){var n=e.metaList;for(var s in n)n[s].mid==t&&(n[s].subList=a)}}},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3)}})},toRecommend:function(t,e){var i=this,n="";if(a.localStorage.getItem("userinfo")){var s=JSON.parse(a.localStorage.getItem("userinfo"));n=s.token}var o={key:t,recommend:e,token:n};uni.showLoading({title:"加载中"}),i.$Net.request({url:i.$API.metaRecommend(),data:o,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:t.data.msg,icon:"none"}),1==t.data.code&&(i.page=1,i.moreText="加载更多",i.isLoad=0,i.getMetaList(!1))},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"}),uni.stopPullDownRefresh()}})},toEdit:function(t){uni.navigateTo({url:"/pages/manage/metasedit?type=edit&mid="+t})},toDelete:function(t){var e=this,i="";if(a.localStorage.getItem("userinfo")){var n=JSON.parse(a.localStorage.getItem("userinfo"));i=n.token}var s={id:t,token:i};uni.showModal({title:"确定要删除该数据吗",success:function(t){t.confirm?(uni.showLoading({title:"加载中"}),e.$Net.request({url:e.$API.deleteMeta(),data:s,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:t.data.msg,icon:"none"}),1==t.data.code&&(e.page=1,e.moreText="加载更多",e.isLoad=0,e.getMetaList(!1))},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"})}})):t.cancel&&console.log("用户点击取消")}})},toAdd:function(){uni.navigateTo({url:"/pages/manage/metasedit?type=add"})},searchTag:function(){this.searchText;this.page=1,this.getMetaList()},searchClose:function(){this.searchText="",this.page=1,this.getMetaList()}}};e.default=n},d065:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"userpost",class:t.AppStyle},[i("v-uni-view",{staticClass:"header",style:[{height:t.CustomBar+"px"}]},[i("v-uni-view",{staticClass:"cu-bar bg-white",style:{height:t.CustomBar+"px","padding-top":t.StatusBar+"px"}},[i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-back"})],1),i("v-uni-view",{staticClass:"content text-bold",style:[{top:t.StatusBar+"px"}]},[t._v("标签及分类")]),i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toAdd.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-add"})],1)],1)],1),i("v-uni-view",{style:[{padding:t.NavBar+"px 10px 0px 10px"}]}),i("v-uni-view",{staticClass:"data-box"},[i("v-uni-view",{staticClass:"cu-bar bg-white search"},[i("v-uni-view",{staticClass:"search-form round"},[i("v-uni-text",{staticClass:"cuIcon-search"}),i("v-uni-input",{attrs:{type:"text",placeholder:"输入搜索关键字"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.searchTag.apply(void 0,arguments)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),""!=t.searchText?i("v-uni-view",{staticClass:"search-close",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.searchClose()}}},[i("v-uni-text",{staticClass:"cuIcon-close"})],1):t._e()],1)],1),i("v-uni-view",{staticClass:"search-type grid col-2"},[i("v-uni-view",{staticClass:"search-type-box",class:"category"==t.type?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toType("category")}}},[i("v-uni-text",[t._v("分类")])],1),i("v-uni-view",{staticClass:"search-type-box",class:"tag"==t.type?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toType("tag")}}},[i("v-uni-text",[t._v("标签")])],1)],1),0==t.metaList.length?i("v-uni-view",{staticClass:"no-data"},[i("v-uni-text",{staticClass:"cuIcon-text"}),t._v("暂时没有数据")],1):t._e(),i("v-uni-view",{staticClass:"cu-card article no-card"},["category"==t.type?t._l(t.metaList,(function(e,a){return i("v-uni-view",{key:a,staticClass:"cu-item shadow"},[i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"desc meta-main"},[i("v-uni-view",{staticClass:"text-content"},[t._v(t._s(e.name)),i("v-uni-text",{staticClass:"meta-id"},[t._v("MID："+t._s(e.mid))])],1)],1)],1),i("v-uni-view",{staticClass:"manage-btn"},[i("v-uni-text",{staticClass:"text-pink radius",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.getSubList(e.mid)}}},[t._v("查看下级")]),0==e.isrecommend?i("v-uni-text",{staticClass:"text-green radius",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toRecommend(e.mid,1)}}},[t._v("推荐")]):i("v-uni-text",{staticClass:"text-grey radius",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toRecommend(e.mid,0)}}},[t._v("取消推荐")]),i("v-uni-text",{staticClass:"text-blue radius",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toEdit(e.mid)}}},[t._v("编辑")]),i("v-uni-text",{staticClass:"text-red radius",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toDelete(e.mid)}}},[t._v("删除")])],1),e.subList.length>0?i("v-uni-view",{staticClass:"category-manage-sub"},t._l(e.subList,(function(e,a){return i("v-uni-view",{key:a,staticClass:"cu-item shadow category-item"},[i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"desc meta-main"},[i("v-uni-view",{staticClass:"text-content"},[t._v(t._s(e.name)),i("v-uni-text",{staticClass:"meta-id"},[t._v("MID："+t._s(e.mid))])],1)],1)],1),i("v-uni-view",{staticClass:"manage-btn"},[0==e.isrecommend?i("v-uni-text",{staticClass:"text-green radius",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toRecommend(e.mid,1)}}},[t._v("推荐")]):i("v-uni-text",{staticClass:"text-grey radius",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toRecommend(e.mid,0)}}},[t._v("取消推荐")]),i("v-uni-text",{staticClass:"text-blue radius",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toEdit(e.mid)}}},[t._v("编辑")]),i("v-uni-text",{staticClass:"text-red radius",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toDelete(e.mid)}}},[t._v("删除")])],1)],1)})),1):t._e()],1)})):t._e(),"tag"==t.type?t._l(t.metaList,(function(e,a){return i("v-uni-view",{key:a,staticClass:"cu-item shadow"},[i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"desc meta-main"},[i("v-uni-view",{staticClass:"text-content"},[t._v(t._s(e.name)),i("v-uni-text",{staticClass:"meta-id"},[t._v("MID："+t._s(e.mid))])],1)],1)],1),i("v-uni-view",{staticClass:"manage-btn"},[0==e.isrecommend?i("v-uni-text",{staticClass:"cu-btn text-green radius",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toRecommend(e.mid,1)}}},[t._v("推荐")]):i("v-uni-text",{staticClass:"cu-btn text-grey radius",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toRecommend(e.mid,0)}}},[t._v("取消推荐")]),i("v-uni-text",{staticClass:"cu-btn text-blue radius",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toEdit(e.mid)}}},[t._v("编辑")]),i("v-uni-text",{staticClass:"cu-btn text-red radius",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toDelete(e.mid)}}},[t._v("删除")])],1)],1)})):t._e(),t.metaList.length>0?i("v-uni-view",{staticClass:"load-more",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.loadMore.apply(void 0,arguments)}}},[i("v-uni-text",[t._v(t._s(t.moreText))])],1):t._e()],2)],1)],1)},n=[]}}]);