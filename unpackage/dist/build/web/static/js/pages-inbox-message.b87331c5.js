(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-inbox-message"],{"64be":function(t,e,i){"use strict";i.r(e);var n=i("6c2c"),a=i.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=a.a},"6c2c":function(t,e,i){"use strict";i("7a82");var n=i("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("fc11"));i("99af"),i("c975"),i("ac1f"),i("5319"),i("5b81"),i("1276"),i("14d9"),i("e25e"),i("fb6a");var s,o=i("625a"),r=n(i("634b")),u={data:function(){return{StatusBar:this.StatusBar,CustomBar:this.CustomBar,NavBar:this.StatusBar+this.CustomBar,AppStyle:this.$store.state.AppStyle,type:"comment",inboxList:[],uid:0,moreText:"加载更多",page:1,token:"",isLoading:0,owo:r.default,owoList:[]}},onPullDownRefresh:function(){this.page=1,this.getInboxList(!1),this.setRead(),setTimeout((function(){uni.stopPullDownRefresh()}),1e3)},onHide:function(){clearInterval(this.msgLoading),this.msgLoading=null},onReachBottom:function(){this.loadMore()},onShow:function(){this.page=1},onLoad:function(t){var e=this.owo.data,i=[];for(var n in e)i=i.concat(e[n].container);if(this.owoList=i,t.type&&(this.type=t.type),o.localStorage.getItem("userinfo")){var a=JSON.parse(o.localStorage.getItem("userinfo"));this.uid=a.uid}o.localStorage.getItem("token")&&(this.token=o.localStorage.getItem("token"),this.getInboxList(!1),this.setRead())},methods:(s={back:function(){clearInterval(this.msgLoading),this.msgLoading=null,uni.navigateBack({delta:1})},loadMore:function(){0==this.isLoad&&"chat"!=this.type&&(this.moreText="正在加载中...",this.getInboxList(!0))},markHtml:function(t){var e=this.owoList;for(var i in e)-1!=this.replaceSpecialChar(t).indexOf(e[i].data)&&(t=this.replaceAll(this.replaceSpecialChar(t),e[i].data,"<img src='/"+e[i].icon+"' class='tImg' />"));return t},replaceAll:function(t,e,i){return t.split(e).join(i)},toInfo:function(t,e){clearInterval(this.msgLoading),this.msgLoading=null,uni.navigateTo({url:"/pages/contents/info?cid="+t+"&title="+e})},goPostInfo:function(t){uni.navigateTo({url:"/pages/forum/info?id="+t})},goInbox:function(t){if("comment"==t.type&&this.toInfo(t.contentsInfo.cid,t.contenTitle),"finance"==t.type&&(clearInterval(this.msgLoading),this.msgLoading=null,uni.navigateTo({url:"/pages/user/assets"})),"system"==t.type)return!1;"postComment"==t.type&&this.goPostInfo(t.postJson.id)},getUserLv:function(t){if(!t)t=0;var e=this.$API.GetRankList();return e[t]},getUserLvStyle:function(t){if(!t)t=0;var e=this.$API.GetRankStyle(),i="color:#fff;background-color: "+e[t];return i},toType:function(t){this.type=t,this.page=1,this.moreText="加载更多",this.isLoad=0,this.inboxList=[],this.getInboxList(!1)},getInboxList:function(t){var e=this,i=e.page;if(t&&i++,""==e.token)return uni.showToast({title:"请先登录",icon:"none",duration:1e3,position:"bottom"}),!1;e.$Net.request({url:e.$API.getInbox(),data:{type:e.type,token:e.token,limit:8,page:i},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"post",dataType:"json",success:function(i){if(e.isLoad=0,1==i.data.code){var n=i.data.data;if(n.length>0){var a=[];for(var s in n){var o=n[s];o.style="background-image:url("+n[s].userJson.avatar+");",a.push(o)}t?(e.page++,e.inboxList=e.inboxList.concat(a)):e.inboxList=a}else e.moreText="没有更多消息了"}setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)},fail:function(t){e.isLoad=0,e.moreText="加载更多";setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)}})},arraysEqual:function(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!=e.length)return!1;for(var i in t)for(var n in e)if(e[n].id==t[i].id&&e[n].lastTime!=t[i].lastTime)return!1},commentsAdd:function(t,e,i,n){clearInterval(this.chatLoading),this.chatLoading=null,uni.navigateTo({url:"/pages/contents/commentsadd?cid="+n+"&coid="+e+"&title="+t+"&isreply="+i})},formatDate:function(t){t=new Date(parseInt(1e3*t));var e=t.getFullYear(),i=("0"+(t.getMonth()+1)).slice(-2),n=("0"+t.getDate()).slice(-2),a=("0"+t.getHours()).slice(-2),s=("0"+t.getMinutes()).slice(-2),o=e+"-"+i+"-"+n+" "+a+":"+s;return o},chatFormatDate:function(t){t=new Date(parseInt(1e3*t));var e=t.getFullYear(),i=("0"+(t.getMonth()+1)).slice(-2),n=("0"+t.getDate()).slice(-2),a=("0"+t.getHours()).slice(-2),s=("0"+t.getMinutes()).slice(-2),o=a+":"+s,r=new Date,u=r.getFullYear(),c=(("0"+(r.getMonth()+1)).slice(-2),("0"+r.getDate()).slice(-2));return o=e==u&&e==u&&n==c?a+":"+s:i+"-"+n,o},replaceSpecialChar:function(t){return!!t&&(t=t.replace(/&quot;/g,'"'),t=t.replace(/&amp;/g,"&"),t=t.replace(/&lt;/g,"<"),t=t.replace(/&gt;/g,">"),t=t.replace(/&nbsp;/g," "),t)}},(0,a.default)(s,"getUserLv",(function(t){if(!t)t=0;var e=this.$API.GetRankList();return e[t]})),(0,a.default)(s,"getUserLvStyle",(function(t){if(!t)t=0;var e=this.$API.GetRankStyle(),i="color:#fff;background-color: "+e[t];return i})),(0,a.default)(s,"setRead",(function(){this.$Net.request({url:this.$API.setRead(),data:{token:this.token,type:this.type},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){t.data.code},fail:function(t){uni.showToast({title:"网络开小差了哦",icon:"none"})}})})),s)};e.default=u},bd44:function(t,e,i){"use strict";i.r(e);var n=i("dc37"),a=i("64be");for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);var o=i("f0c5"),r=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"73f69d07",null,!1,n["a"],void 0);e["default"]=r.exports},dc37:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{class:t.$store.state.AppStyle},[n("v-uni-view",{staticClass:"header",style:[{height:t.CustomBar+"px"}]},[n("v-uni-view",{staticClass:"cu-bar bg-white",style:{height:t.CustomBar+"px","padding-top":t.StatusBar+"px"}},[n("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"cuIcon-back"})],1),n("v-uni-view",{staticClass:"content text-bold",style:[{top:t.StatusBar+"px"}]},["comment"==t.type?[t._v("收到的评论")]:t._e(),"system"==t.type?[t._v("系统通知")]:t._e(),"finance"==t.type?[t._v("财务通知")]:t._e()],2),n("v-uni-view",{staticClass:"action"})],1)],1),n("v-uni-view",{style:[{padding:t.NavBar+"px 10px 0px 10px"}]}),n("v-uni-view",{staticClass:"data-box data-inbox"},[n("v-uni-view",{staticClass:"cu-card dynamic no-card"},[n("v-uni-view",{staticClass:"cu-item"},[n("v-uni-view",{staticClass:"cu-list menu-avatar comment"},[0==t.inboxList.length?n("v-uni-view",{staticClass:"no-data"},[t._v("暂时没有消息")]):t._e(),n("v-uni-view",{staticClass:"cu-card dynamic no-card",staticStyle:{"margin-top":"20upx"}},t._l(t.inboxList,(function(e,i){return t.inboxList.length>0?n("v-uni-view",{key:i,staticClass:"cu-item"},[n("v-uni-view",{staticClass:"cu-list menu-avatar comment",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.goInbox(e)}}},[n("v-uni-view",{staticClass:"cu-item"},[n("v-uni-view",{staticClass:"cu-avatar round",style:e.style}),n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{staticClass:"text-grey"},[t._v(t._s(e.userJson.name)),"system"==e.type?[n("v-uni-text",{staticClass:"userlv bg-red"},[t._v("系统通知")])]:t._e(),"finance"==e.type?[n("v-uni-text",{staticClass:"userlv bg-gradual-orange"},[t._v("财务通知")])]:t._e(),"comment"==e.type?[n("v-uni-text",{staticClass:"userlv",style:t.getUserLvStyle(e.userJson.lv)},[t._v(t._s(t.getUserLv(e.userJson.lv)))]),e.userJson.customize&&""!=e.userJson.customize?n("v-uni-text",{staticClass:"userlv customize"},[t._v(t._s(e.userJson.customize))]):t._e(),e.userJson.isvip>0?[1==e.userJson.vip?[n("v-uni-text",{staticClass:"isVIP bg-gradual-red"},[t._v("VIP")])]:[n("v-uni-text",{staticClass:"isVIP bg-yellow"},[t._v("VIP")])]]:t._e()]:t._e()],2),n("v-uni-view",{staticClass:"text-content text-df break-all"},[n("v-uni-rich-text",{attrs:{nodes:t.markHtml(e.text)}})],1),"comment"==e.type?n("v-uni-view",{staticClass:"bg-grey light padding-sm radius margin-top-sm  text-sm"},[n("v-uni-view",{staticClass:"flex"},[n("v-uni-view",[t._v(t._s(e.contenTitle))])],1)],1):t._e(),"postComment"==e.type?n("v-uni-view",{staticClass:"bg-grey light padding-sm radius margin-top-sm  text-sm"},[n("v-uni-view",{staticClass:"flex"},[n("v-uni-view",[t._v(t._s(e.postTitle))])],1)],1):t._e(),n("v-uni-view",{staticClass:"margin-top-sm flex justify-between"},[n("v-uni-view",{staticClass:"text-gray text-df"},[t._v(t._s(t.formatDate(e.created)))]),n("v-uni-view")],1)],1)],1)],1)],1):t._e()})),1),t.inboxList.length>0?n("v-uni-view",{staticClass:"load-more",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.loadMore.apply(void 0,arguments)}}},[n("v-uni-text",[t._v(t._s(t.moreText))])],1):t._e()],1)],1)],1)],1),0==t.isLoading?n("v-uni-view",{staticClass:"loading"},[n("v-uni-view",{staticClass:"loading-main"},[n("v-uni-image",{attrs:{src:i("14d6")}})],1)],1):t._e()],1)},a=[]}}]);