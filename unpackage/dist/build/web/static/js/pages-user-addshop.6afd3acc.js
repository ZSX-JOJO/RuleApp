(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user-addshop"],{"53aa":function(t,e,i){"use strict";i("7a82");var n=i("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("fc11"));i("fb6a"),i("ac1f"),i("5319"),i("e9c4");n(i("631a"));var o,s=i("625a"),u={data:function(){return{StatusBar:this.StatusBar,CustomBar:this.CustomBar,NavBar:this.StatusBar+this.CustomBar,AppStyle:this.$store.state.AppStyle,modalName:"",metaList:[{name:"实体商品",mid:1},{name:"源码",mid:2},{name:"软件工具",mid:3},{name:"付费阅读",mid:4}],token:"",isShow:!1,curHeight:0,jpHeight:0,screenHeight:0,postheight:0,poststyle:"",readstyle:"",isText:0,title:"",category:-1,categoryText:"",text:"",isInfo:0,link:{title:"",url:""},type:"add",sid:0,start:-1,isSpace:!1}},onPullDownRefresh:function(){},onHide:function(){},onShow:function(){if(s.localStorage.getItem("userinfo")){var t=JSON.parse(s.localStorage.getItem("userinfo"));this.token=t.token}s.localStorage.getItem("userShopinfo")&&(this.isInfo=1)},onLoad:function(t){var e=this;t.type&&(e.type=t.type,t.sid?(e.sid=t.sid,e.getInfo(e.sid)):(s.localStorage.removeItem("userShopinfo"),e.isInfo=0)),t.isSpace&&1==t.isSpace&&(e.isSpace=!0);var i=uni.getSystemInfoSync().screenHeight;uni.getSystemInfoSync().statusBarHeight;e.screenHeight=i-e.NavBar,e.postheight=300,e.poststyle="height:300px",e.readstyle="height:330px",uni.onKeyboardHeightChange((function(t){if(0==t.height)e.focalize(t.height),e.poststyle="height:300px";else{e.curHeight=t.height;var i=300-t.height;e.focus(t.height),e.poststyle="height:"+i+"px"}}))},methods:(o={toSpace:function(t){this.isSpace=t.detail.value},ToisText:function(t){var e=this;e.isText=t,0!=e.curHeight&&1==e.isText&&e.focus(e.curHeight),uni.getSelectedTextRange({success:function(t){e.start=t.start}})},insetText:function(t){var e=this.start,i=this.text;-1==e?i+=t:i=i.slice(0,e)+t+i.slice(e),this.text=i},focus:function(t){if(0==this.isText)return!1},focalize:function(t){},back:function(){s.localStorage.removeItem("userShopinfo"),uni.navigateBack({delta:1})},PickerChange:function(t){this.index=t.detail.value},showModal:function(t){this.modalName=t.currentTarget.dataset.target},hideModal:function(){this.modalName=null},textareaAInput:function(){var t=this;uni.getSelectedTextRange({success:function(e){t.start=e.start}})},toBold:function(){this.insetText("**加粗文字**")},toItalic:function(){this.insetText("*斜体文字* ")},toTitle:function(t){for(var e="",i=0;i<t;i++)e+="#";this.text;this.insetText(e),this.hideModal()},toCode:function(){var t="";""!=this.text&&(t="\n");var e=t+"```javascript\n代码片段\n```";this.insetText(e)},tolinks:function(){var t=this.link;if(""==t.title||""==t.url)return uni.showToast({title:"请输入正确的参数",icon:"none",duration:1e3,position:"bottom"}),!1;var e="["+t.title+"]("+t.url+")";this.insetText(e),this.link={title:"",url:""},this.hideModal()},upload:function(){var t=this;uni.chooseImage({count:1,sizeType:["original"],sourceType:["album","camera"],success:function(e){uni.showLoading({title:"加载中"});var i=e.tempFilePaths,n=uni.uploadFile({url:t.$API.upload(),filePath:i[0],name:"file",formData:{token:t.token},success:function(e){setTimeout((function(){uni.hideLoading()}),1e3);var i=JSON.parse(e.data);if(uni.showToast({title:i.msg,icon:"none"}),1==i.code){var n="";""!=t.text&&(n="\n");var a=n+"![图片名称]("+i.data.url+")";t.insetText(a)}},fail:function(){setTimeout((function(){uni.hideLoading()}),1e3)}});n.onProgressUpdate((function(t){}))}})},uploadVideo:function(){var t=this;uni.chooseVideo({sourceType:["camera","album"],compressed:!1,success:function(e){uni.showLoading({title:"加载中"});var i=e.tempFilePath;uni.uploadFile({url:t.$API.upload(),filePath:i,name:"file",formData:{token:t.token},success:function(e){setTimeout((function(){uni.hideLoading()}),1e3);var i=JSON.parse(e.data);if(uni.showToast({title:i.msg,icon:"none"}),1==i.code){var n="";""!=t.text&&(n="\n");var a=n+'\n!!!\n<video src="'.concat(i.data.url,'" controls width="100%"></video>\n!!!\n\t\t\t\t\t\t\t   ');t.insetText(a)}},fail:function(){uni.showToast({title:"网络异常，上传失败！",icon:"none"}),setTimeout((function(){uni.hideLoading()}),1e3)}})}})}},(0,a.default)(o,"uploadVideo",(function(){var t=this;uni.chooseVideo({sourceType:["camera","album"],compressed:!1,success:function(e){uni.showLoading({title:"加载中"});var i=e.tempFilePath;uni.uploadFile({url:t.$API.upload(),filePath:i,name:"file",formData:{token:t.token},success:function(e){setTimeout((function(){uni.hideLoading()}),1e3);var i=JSON.parse(e.data);if(uni.showToast({title:i.msg,icon:"none"}),1==i.code){var n="";""!=t.text&&(n="\n");var a=n+'\n!!!\n<video src="'.concat(i.data.url,'" controls width="100%"></video>\n!!!\n\t\t\t\t\t\t\t   ');t.insetText(a)}},fail:function(){uni.showToast({title:"网络异常，上传失败！",icon:"none"}),setTimeout((function(){uni.hideLoading()}),1e3)}})}})})),(0,a.default)(o,"toIsShow",(function(){this.isShow=!this.isShow})),(0,a.default)(o,"submit",(function(){var t=this.type;"add"==t?this.addShop():this.editShop()})),(0,a.default)(o,"addShop",(function(){var t=this;if(""==t.title||-1==t.category||""==t.text)return uni.showToast({title:"请输入正确的参数",icon:"none",duration:1e3,position:"bottom"}),!1;var e="";if(!s.localStorage.getItem("userShopinfo"))return uni.showToast({title:"请完成商品详细设置",icon:"none"}),!1;e=JSON.parse(s.localStorage.getItem("userShopinfo"));var i=0;t.isSpace&&(i=1);var n={title:t.title,type:t.category,imgurl:e.imgurl,price:e.price,num:e.num,value:e.value,vipDiscount:e.vipDiscount};uni.showLoading({title:"加载中"});var a=t.text;a=a.replace(/\r\n/g,"||rn||"),a=a.replace(/\n/g,"||rn||"),t.$Net.request({url:t.$API.addShop(),data:{params:JSON.stringify(t.$API.removeObjectEmptyKey(n)),token:t.token,text:a,isSpace:i},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"post",dataType:"json",success:function(e){if(setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:e.data.msg,icon:"none"}),1==e.data.code){s.localStorage.removeItem("userShopinfo");setTimeout((function(){t.back()}),1e3)}},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"}),uni.stopPullDownRefresh()}})})),(0,a.default)(o,"editShop",(function(){var t=this;if(""==t.title||-1==t.category||""==t.text)return uni.showToast({title:"请输入正确的参数",icon:"none",duration:1e3,position:"bottom"}),!1;var e="";if(!s.localStorage.getItem("userShopinfo"))return uni.showToast({title:"请完成商品详细设置",icon:"none"}),!1;e=JSON.parse(s.localStorage.getItem("userShopinfo"));var i={id:t.sid,title:t.title,type:t.category,text:t.text,imgurl:e.imgurl,price:e.price,num:e.num,value:e.value,vipDiscount:e.vipDiscount},n=t.text;n=n.replace(/\r\n/g,"||rn||"),n=n.replace(/\n/g,"||rn||"),uni.showLoading({title:"加载中"}),t.$Net.request({url:t.$API.editShop(),data:{params:JSON.stringify(t.$API.removeObjectEmptyKey(i)),token:t.token},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"post",dataType:"json",success:function(e){if(setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:e.data.msg,icon:"none"}),1==e.data.code){s.localStorage.removeItem("userShopinfo");setTimeout((function(){t.back()}),1e3)}},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"}),uni.stopPullDownRefresh()}})})),(0,a.default)(o,"toMate",(function(t){this.categoryText=t.name,this.category=t.mid,this.hideModal()})),(0,a.default)(o,"toSetShopInfo",(function(){uni.navigateTo({url:"/pages/user/addshopinfo"})})),(0,a.default)(o,"getInfo",(function(t){var e=this,i="";if(s.localStorage.getItem("userinfo")){var n=JSON.parse(s.localStorage.getItem("userinfo"));i=n.token}var a={key:e.sid,token:i};e.$Net.request({url:e.$API.shopInfo(),data:a,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){uni.stopPullDownRefresh(),e.title=t.data.title,e.category=t.data.type,e.text=t.data.text;var i={imgurl:t.data.imgurl,price:t.data.price,num:t.data.num,value:t.data.value,vipDiscount:t.data.vipDiscount};e.categoryText=e.metaList[e.category-1].name,s.localStorage.setItem("userShopinfo",JSON.stringify(i)),e.isInfo=1},fail:function(t){uni.stopPullDownRefresh(),uni.showToast({title:"网络开小差了哦",icon:"none"})}})})),o)};e.default=u},"730e":function(t,e,i){var n=i("9503");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("760d850b",n,!0,{sourceMap:!1,shadowMode:!1})},7826:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}));var n={mpHtml:i("631a").default},a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"post",class:t.AppStyle},[i("v-uni-view",{staticClass:"header",style:[{height:t.CustomBar+"px"},{top:t.jpHeight+"px"}]},[i("v-uni-view",{staticClass:"cu-bar bg-white",style:{height:t.CustomBar+"px","padding-top":t.StatusBar+"px"}},[i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-back"})],1),i("v-uni-view",{staticClass:"content text-bold",style:[{top:t.StatusBar+"px"}]},["edit"==t.type?[t._v("修改商品")]:[t._v("发布商品")]],2),i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[i("v-uni-button",{staticClass:"cu-btn round bg-blue"},[t._v("发布")])],1)],1)],1),i("v-uni-view",{style:[{padding:t.NavBar+"px 10px 0px 10px"}]}),i("v-uni-form",[i("v-uni-view",{staticClass:"cu-form-group margin-top"},[i("v-uni-view",{staticClass:"title"},[t._v("商品标题")]),i("v-uni-input",{attrs:{placeholder:"输入商品标题",name:"input","adjust-position":!1,focus:!1},on:{focus:function(e){arguments[0]=e=t.$handleEvent(e),t.ToisText(0)},blur:function(e){arguments[0]=e=t.$handleEvent(e),t.ToisText(0)}},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("商品分类")]),i("v-uni-view",{staticClass:"picker",attrs:{"data-target":"metaModal"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showModal.apply(void 0,arguments)}}},[""==t.categoryText?[t._v("选择商品分类")]:[t._v(t._s(t.categoryText))],i("v-uni-text",{staticClass:"cuIcon-right"})],2)],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("详细设置"),0==t.isInfo?i("v-uni-text",{staticClass:"text-gray text-sm margin-left"},[t._v("未设置")]):i("v-uni-text",{staticClass:"text-blue text-sm margin-left"},[t._v("已设置")])],1),i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toSetShopInfo.apply(void 0,arguments)}}},[t._v("设置收费内容，缩略图"),i("v-uni-text",{staticClass:"cuIcon-right"})],1)],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("转发到动态")]),i("v-uni-switch",{class:t.isSpace?"checked":"",attrs:{checked:!!t.isSpace},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.toSpace.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"edit-tool"},[i("v-uni-text",{attrs:{"data-target":"RadioModal"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showModal.apply(void 0,arguments)}}},[t._v("H")]),i("v-uni-text",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toBold.apply(void 0,arguments)}}},[t._v("B")]),i("v-uni-text",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toItalic.apply(void 0,arguments)}}},[t._v("I")]),i("v-uni-text",{staticClass:"cuIcon-picfill",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.upload.apply(void 0,arguments)}}}),i("v-uni-text",{staticClass:"cuIcon-playfill",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadVideo.apply(void 0,arguments)}}}),i("v-uni-text",{staticClass:"cuIcon-font",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toCode.apply(void 0,arguments)}}}),i("v-uni-text",{staticClass:"cuIcon-link",attrs:{"data-target":"LinksModal"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showModal.apply(void 0,arguments)}}}),i("v-uni-text",{staticClass:"cuIcon-read",class:t.isShow?"text-blue":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toIsShow.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"cu-form-group"},[t.isShow?t._e():i("v-uni-textarea",{staticClass:"text",style:t.poststyle,attrs:{maxlength:"-1",placeholder:"商品介绍","adjust-position":!1,focus:!1},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.textareaAInput.apply(void 0,arguments)},focus:function(e){arguments[0]=e=t.$handleEvent(e),t.ToisText(1)},blur:function(e){arguments[0]=e=t.$handleEvent(e),t.ToisText(0)}},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),t.isShow?i("v-uni-scroll-view",{staticClass:"text",style:t.readstyle,attrs:{"scroll-y":!0}},[i("mp-html",{attrs:{content:t.text,selectable:!0,"show-img-menu":!0,"lazy-load":!0,markdown:!0,"scroll-table":!0}})],1):t._e()],1)],1),i("v-uni-view",{staticClass:"cu-modal",class:"metaModal"==t.modalName?"show":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideModal.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"cu-dialog",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}}},[i("v-uni-radio-group",{staticClass:"block"},[i("v-uni-view",{staticClass:"cu-list menu text-left"},t._l(t.metaList,(function(e,n){return i("v-uni-view",{key:n,staticClass:"cu-item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toMate(e)}}},[i("v-uni-label",{staticClass:"flex justify-between align-center flex-sub"},[i("v-uni-view",{staticClass:"flex-sub"},[t._v(t._s(e.name))]),i("v-uni-radio",{staticClass:"round"})],1)],1)})),1)],1)],1)],1),i("v-uni-view",{staticClass:"cu-modal",class:"RadioModal"==t.modalName?"show":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideModal.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"cu-dialog",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}}},[i("v-uni-radio-group",{staticClass:"block"},[i("v-uni-view",{staticClass:"cu-list menu text-left"},t._l(5,(function(e,n){return i("v-uni-view",{key:n,staticClass:"cu-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toTitle(n+1)}}},[i("v-uni-label",{staticClass:"flex justify-between align-center flex-sub"},[i("v-uni-view",{staticClass:"flex-sub"},[t._v("标题 "+t._s(n+1))]),i("v-uni-radio",{staticClass:"round"})],1)],1)})),1)],1)],1)],1),i("v-uni-view",{staticClass:"cu-modal LinksModal",class:"LinksModal"==t.modalName?"show":""},[i("v-uni-view",{staticClass:"cu-dialog"},[i("v-uni-view",{staticClass:"cu-bar bg-white justify-end"},[i("v-uni-view",{staticClass:"content"},[t._v("插入外部链接")]),i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideModal.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-close text-red"})],1)],1),i("v-uni-view",{staticClass:"padding-xl"},[i("v-uni-input",{attrs:{placeholder:"链接标题"},model:{value:t.link.title,callback:function(e){t.$set(t.link,"title",e)},expression:"link.title"}}),i("v-uni-input",{attrs:{placeholder:"http(s)://"},model:{value:t.link.url,callback:function(e){t.$set(t.link,"url",e)},expression:"link.url"}})],1),i("v-uni-view",{staticClass:"cu-bar bg-white justify-end"},[i("v-uni-view",{staticClass:"action"},[i("v-uni-button",{staticClass:"cu-btn line-blue text-blue",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideModal.apply(void 0,arguments)}}},[t._v("取消")]),i("v-uni-button",{staticClass:"cu-btn bg-blue margin-left",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tolinks.apply(void 0,arguments)}}},[t._v("确定")])],1)],1)],1)],1)],1)},o=[]},9188:function(t,e,i){"use strict";i.r(e);var n=i("53aa"),a=i.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},9503:function(t,e,i){var n=i("24fb");e=n(!1),e.push([t.i,"uni-page-body[data-v-03699405]{overflow:hidden}.post[data-v-03699405]{display:flex;flex:1;flex-direction:column;justify-content:space-between}",""]),t.exports=e},b7ae:function(t,e,i){"use strict";i.r(e);var n=i("7826"),a=i("9188");for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("f88b");var s=i("f0c5"),u=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"03699405",null,!1,n["a"],void 0);e["default"]=u.exports},f88b:function(t,e,i){"use strict";var n=i("730e"),a=i.n(n);a.a}}]);