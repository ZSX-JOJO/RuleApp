(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-shop"],{"02d8":function(t,e,s){"use strict";s.d(e,"b",(function(){return i})),s.d(e,"c",(function(){return o})),s.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"user",class:t.$store.state.AppStyle},[i("v-uni-view",{staticClass:"header",style:[{height:t.CustomBar+"px"}]},[i("v-uni-view",{staticClass:"cu-bar bg-white",style:{height:t.CustomBar+"px","padding-top":t.StatusBar+"px"}},[i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-back"})],1),i("v-uni-view",{staticClass:"content text-bold",style:[{top:t.StatusBar+"px"}]},[t._v("商品管理")])],1)],1),i("v-uni-view",{style:[{padding:t.NavBar+"px 10px 0px 10px"}]}),i("v-uni-view",{staticClass:"data-box"},[i("v-uni-view",{staticClass:"fullpost-btn"},["administrator"==t.group?i("v-uni-text",{staticClass:"cu-btn bg-blue radius",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toSort.apply(void 0,arguments)}}},[t._v("商品分类")]):t._e()],1),i("v-uni-view",{staticClass:"cu-bar bg-white search"},[i("v-uni-view",{staticClass:"search-form round"},[i("v-uni-text",{staticClass:"cuIcon-search"}),i("v-uni-input",{attrs:{type:"text",placeholder:"输入搜索关键字"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.searchTag.apply(void 0,arguments)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),""!=t.searchText?i("v-uni-view",{staticClass:"search-close",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.searchClose()}}},[i("v-uni-text",{staticClass:"cuIcon-close"})],1):t._e()],1)],1),i("v-uni-view",{staticClass:"shop-sort shop-filter"},[i("v-uni-view",{staticClass:"grid col-2 text-center"},[i("v-uni-view",{staticClass:"shop-filter-box text-bold",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.sortShow=!t.sortShow,t.subtypeShow=!1}}},[0==t.sort?[t._v("全部大类")]:[t._v(t._s(t.sortText))],i("v-uni-text",{staticClass:"cuIcon-unfold margin-left-sm"})],2),i("v-uni-view",{staticClass:"shop-filter-box text-bold",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.subtypeShow=!t.subtypeShow,t.sortShow=!1}}},[0==t.sort||""==t.subtypeText?[t._v("全部")]:[t._v(t._s(t.subtypeText))],i("v-uni-text",{staticClass:"cuIcon-unfold margin-left-sm"})],2)],1),t.sortShow?i("v-uni-view",{staticClass:"shop-sort-list"},[i("v-uni-view",{staticClass:"shop-sort-list-box",class:0==t.sort?"text-blue":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.setSort(null)}}},[t._v("全部")]),t._l(t.sortList,(function(e,s){return i("v-uni-view",{staticClass:"shop-sort-list-box",class:e.id==t.sort?"text-blue":"",on:{click:function(s){arguments[0]=s=t.$handleEvent(s),t.setSort(e)}}},[t._v(t._s(e.name))])}))],2):t._e(),t.subtypeShow?i("v-uni-view",{staticClass:"shop-sort-list"},[i("v-uni-view",{staticClass:"shop-sort-list-box",class:0==t.subtype?"text-blue":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.setSubtype(null)}}},[t._v("全部")]),t._l(t.subtypeList,(function(e,s){return i("v-uni-view",{staticClass:"shop-sort-list-box",class:e.id==t.subtype?"text-blue":"",on:{click:function(s){arguments[0]=s=t.$handleEvent(s),t.setSubtype(e)}}},[t._v(t._s(e.name))])}))],2):t._e()],1),t.sortShow||t.subtypeShow?i("v-uni-view",{staticClass:"shop-sort-list-bg",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.sortShow=!1,t.subtypeShow=!1}}}):t._e(),i("v-uni-view",{staticClass:"search-type grid col-2"},[i("v-uni-view",{staticClass:"search-type-box",class:0==t.status?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toType(0)}}},[i("v-uni-text",[t._v("待审核")])],1),i("v-uni-view",{staticClass:"search-type-box",class:1==t.status?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toType(1)}}},[i("v-uni-text",[t._v("已上架")])],1)],1),0==t.shopList.length?i("v-uni-view",{staticClass:"no-data"},[t._v("暂时没有商品")]):t._e(),i("v-uni-view",{staticClass:"shop-list"},[t._l(t.shopList,(function(e,s){return[i("shopItem",{key:s+"_0",attrs:{item:e,isAdmin:!0},on:{updateList:function(e){arguments[0]=e=t.$handleEvent(e),t.updateList.apply(void 0,arguments)}}})]}))],2)],1),t.shopList.length>0?i("v-uni-view",{staticClass:"load-more",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.loadMore.apply(void 0,arguments)}}},[i("v-uni-text",[t._v(t._s(t.moreText))])],1):t._e(),0==t.isLoading?i("v-uni-view",{staticClass:"loading"},[i("v-uni-view",{staticClass:"loading-main"},[i("v-uni-image",{attrs:{src:s("14d6")}})],1)],1):t._e()],1)},o=[]},"1e01":function(t,e,s){"use strict";s("7a82");var i=s("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,s("14d9"),s("4e82"),s("e9c4"),s("99af");var o=i(s("74ee")),n=s("625a"),a={data:function(){return{StatusBar:this.StatusBar,CustomBar:this.CustomBar,NavBar:this.StatusBar+this.CustomBar,AppStyle:this.$store.state.AppStyle,userInfo:null,uid:0,token:"",shopList:[],isLoad:0,page:1,moreText:"加载更多",type:1,searchText:"",status:0,isLoading:0,group:"",shopTypelist:[],sortShow:!1,sort:0,sortText:"",sortList:[],subtypeShow:!1,subtype:0,subtypeText:"",subtypeList:[]}},onPullDownRefresh:function(){this.page=1,this.getShopList(),this.getShopTypeList();setTimeout((function(){uni.stopPullDownRefresh()}),1e3)},onReachBottom:function(){0==this.isLoad&&this.loadMore()},onShow:function(){n.localStorage.getItem("userinfo")&&(this.userInfo=JSON.parse(n.localStorage.getItem("userinfo")),this.uid=this.userInfo.uid,this.group=this.userInfo.group),n.localStorage.getItem("token")&&(this.token=n.localStorage.getItem("token")),this.isLoad=0,this.page=1},onLoad:function(){this.getShopList(),this.getShopTypeList()},methods:{back:function(){uni.navigateBack({delta:1})},loadMore:function(){this.moreText="正在加载中...",this.isLoad=1,this.getShopList(!0)},getShopTypeList:function(){var t=this;t.$Net.request({url:t.$API.shopTypeList(),data:{limit:50,page:1,token:t.token},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){if(uni.stopPullDownRefresh(),t.isLoad=0,1==e.data.code){t.shopTypelist=e.data.data;var s=e.data.data,i=[];for(var o in s)0==s[o].parent&&i.push(s[o]);if(t.sortList=i,t.sort>0)for(var n in i)i[n].id==t.sort&&t.setSort(i[n],!0)}setTimeout((function(){t.isLoading=1,clearTimeout("timer")}),300)},fail:function(e){uni.stopPullDownRefresh(),t.moreText="加载更多",t.isLoad=0;setTimeout((function(){t.isLoading=1,clearTimeout("timer")}),300)}})},setSort:function(t,e){if(this.sortShow=!1,null==t)return this.sort=0,this.sortText="",this.subtype=0,this.subtypeText="",this.page=1,this.getShopList(),!1;if(this.sort=t.id,this.sortText=t.name,0!=this.sort){var s=this.shopTypelist,i=[];for(var o in s)s[o].parent==this.sort&&i.push(s[o]);this.subtypeList=i,this.subtype=0,this.subtypeText=""}this.getShopList()},setSubtype:function(t){if(this.subtypeShow=!1,null==t)return this.subtype=0,this.subtypeText="",this.page=1,this.getShopList(),!1;this.subtype=t.id,this.subtypeText=t.name,this.getShopList()},getShopList:function(t){var e=this;if(!n.localStorage.getItem("userinfo")){uni.showToast({title:"请先登录",icon:"none",duration:1e3,position:"bottom"});setTimeout((function(){uni.navigateTo({url:"/pages/user/login"}),clearTimeout("timer")}),1e3);return!1}var s=JSON.parse(n.localStorage.getItem("userinfo"));s.uid;var i={status:e.status};0!=e.sort&&(i.sort=e.sort),0!=e.subtype&&(i.subtype=e.subtype);var o=e.page;t&&o++,e.$Net.request({url:e.$API.shopList(),data:{searchParams:JSON.stringify(e.$API.removeObjectEmptyKey(i)),limit:6,searchKey:e.searchText,page:o,order:"created"},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(s){setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300);if(e.isLoad=0,e.moreText="加载更多",1==s.data.code){var i=s.data.data;0==i.length&&(e.moreText="没有更多数据了"),t?i.length>0&&(e.page++,e.shopList=e.shopList.concat(i)):e.shopList=i}},fail:function(t){e.moreText="加载更多",e.isLoad=0,uni.showToast({title:"网络开小差了哦",icon:"none"});setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)}})},deleteShop:function(t){var e=this,s="";if(!n.localStorage.getItem("userinfo")){uni.showToast({title:"请先登录",icon:"none",duration:1e3,position:"bottom"});setTimeout((function(){uni.navigateTo({url:"/pages/user/login"}),clearTimeout("timer")}),1e3);return!1}var i=JSON.parse(n.localStorage.getItem("userinfo"));s=i.token;var o={key:t,token:s};uni.showModal({title:"确定要删除此商品吗?",content:" ",success:function(t){t.confirm&&(uni.showLoading({title:"加载中"}),e.$Net.request({url:e.$API.deleteShop(),data:o,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:t.data.msg,icon:"none"}),1==t.data.code&&(e.page=1,e.getShopList())},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"}),uni.stopPullDownRefresh()}}))}})},searchTag:function(){this.searchText;this.page=1,this.getShopList()},searchClose:function(){this.searchText="",this.page=1,this.getShopList()},toShop:function(t){uni.navigateTo({url:"/pages/user/addshop"})},editShop:function(t){var e=t.id,s=t.isMd;1==s?uni.navigateTo({url:"/pages/user/addshop?type=edit&sid="+e}):uni.navigateTo({url:"/pages/edit/addshop?type=edit&id="+e})},auditShop:function(t){var e=this,s="";if(!n.localStorage.getItem("userinfo")){uni.showToast({title:"请先登录",icon:"none",duration:1e3,position:"bottom"});setTimeout((function(){uni.navigateTo({url:"/pages/user/login"}),clearTimeout("timer")}),1e3);return!1}var i=JSON.parse(n.localStorage.getItem("userinfo"));s=i.token;var o={key:t,token:s};uni.showModal({title:"确定审核通过该商品吗?",content:" ",success:function(t){t.confirm&&(uni.showLoading({title:"加载中"}),e.$Net.request({url:e.$API.auditShop(),data:o,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:t.data.msg,icon:"none"}),1==t.data.code&&(e.page=1,e.getShopList())},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"}),uni.stopPullDownRefresh()}}))}})},toType:function(t){this.status=t,this.page=1,this.moreText="加载更多",this.isLoad=0,this.getShopList(!1)},updateList:function(){this.page=1,this.moreText="加载更多",this.isLoad=0,this.getShopList(!1)},getUserInfo:function(t){var e=this;uni.showLoading({title:"加载中"}),e.$Net.request({url:e.$API.getUserInfo(),data:{key:t},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){if(setTimeout((function(){uni.hideLoading()}),500),1==t.data.code){var s=t.data.data;e.toUserContents(s)}else uni.showToast({title:t.data.msg,icon:"none"})},fail:function(t){setTimeout((function(){uni.hideLoading()}),500),uni.showToast({title:"网络开小差了哦",icon:"none"})}})},toUserContents:function(t){var e=t.name,s=t.name+"的信息";t.screenName&&(s=t.screenName+" 的信息",e=t.screenName);var i=t.uid;uni.navigateTo({url:"/pages/contents/userinfo?title="+s+"&name="+e+"&uid="+i+"&avatar="+encodeURIComponent(t.avatar)})},toSort:function(){uni.navigateTo({url:"/pages/manage/shoptype"})}},components:{waves:o.default}};e.default=a},b5b3:function(t,e,s){"use strict";s.r(e);var i=s("1e01"),o=s.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){s.d(e,t,(function(){return i[t]}))}(n);e["default"]=o.a},f607:function(t,e,s){"use strict";s.r(e);var i=s("02d8"),o=s("b5b3");for(var n in o)["default"].indexOf(n)<0&&function(t){s.d(e,t,(function(){return o[t]}))}(n);var a=s("f0c5"),u=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,"30735f7c",null,!1,i["a"],void 0);e["default"]=u.exports}}]);