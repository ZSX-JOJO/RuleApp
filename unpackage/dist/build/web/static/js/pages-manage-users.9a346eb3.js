(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-users"],{3421:function(t,e,a){"use strict";a.r(e);var i=a("62bb"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=s.a},"62bb":function(t,e,a){"use strict";a("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("e25e"),a("fb6a"),a("14d9"),a("99af"),a("e9c4");var i=a("625a"),s={data:function(){return{StatusBar:this.StatusBar,CustomBar:this.CustomBar,NavBar:this.StatusBar+this.CustomBar,AppStyle:this.$store.state.AppStyle,userList:[],page:1,moreText:"加载更多",isLoad:0,searchText:"",isLoading:0,type:"",dataType:"all",group:"",token:""}},onPullDownRefresh:function(){this.page=1,this.getUserList(!1);setTimeout((function(){uni.stopPullDownRefresh()}),1e3)},onReachBottom:function(){0==this.isLoad&&this.loadMore()},onShow:function(){if(i.localStorage.getItem("userinfo")){var t=JSON.parse(i.localStorage.getItem("userinfo"));this.group=t.group}i.localStorage.getItem("token")&&(this.token=i.localStorage.getItem("token")),this.page=1},onLoad:function(t){t.type&&(this.type=t.type),this.getUserList(!1)},methods:{allCache:function(){i.localStorage.getItem("userList")&&(this.userList=JSON.parse(i.localStorage.getItem("userList")))},back:function(){uni.navigateBack({delta:1})},toEdit:function(t){uni.navigateTo({url:"/pages/manage/usersedit?uid="+t})},formatDate:function(t){t=new Date(parseInt(1e3*t));var e=t.getFullYear(),a=("0"+(t.getMonth()+1)).slice(-2),i=("0"+t.getDate()).slice(-2),s=("0"+t.getHours()).slice(-2),n=("0"+t.getMinutes()).slice(-2),o=e+"-"+a+"-"+i+" "+s+":"+n;return o},loadMore:function(){this.moreText="正在加载中...",this.isLoad=1,this.getUserList(!0)},getType:function(t){this.dataType=t,this.page=1,this.userList=[],this.getUserList(!1)},searchClose:function(){this.searchText="",this.page=1,this.getUserList(!1)},getUserList:function(t){var e=this;i.localStorage.getItem("token")&&(e.token=i.localStorage.getItem("token"));var a=e.page;t&&a++;var s={};"all"!=e.dataType&"vip"!=e.dataType&&(s={groupKey:e.dataType}),"vip"==e.dataType&&(s={vip:1}),"ban"==e.dataType&&(s={bantime:1}),e.$Net.request({url:e.$API.getUserList(),data:{searchParams:s,limit:10,page:a,searchKey:e.searchText,order:"created",token:e.token},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(a){if(e.isLoad=0,1==a.data.code){var s=a.data.data;if(s.length>0){var n=[];for(var o in s){var c=s[o];c.style="background-image:url("+s[o].avatar+");",n.push(c)}t?(e.page++,e.userList=e.userList.concat(n)):e.userList=n,i.localStorage.setItem("userList",JSON.stringify(e.userList))}else e.moreText="没有更多数据了"}setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)},fail:function(t){e.isLoad=0,e.moreText="加载更多";setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)}})},searchTag:function(){this.searchText;this.page=1,this.getUserList()},deleteUser:function(t){var e=this,a="";if(i.localStorage.getItem("userinfo")){var s=JSON.parse(i.localStorage.getItem("userinfo"));a=s.token}var n={key:t,token:a};uni.showModal({title:"确定要删除该用户吗",success:function(t){t.confirm?(uni.showLoading({title:"加载中"}),e.$Net.request({url:e.$API.userDelete(),data:n,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:t.data.msg,icon:"none"}),1==t.data.code&&(e.page=1,e.getUserList())},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"})}})):t.cancel&&console.log("用户点击取消")}})},unblockUser:function(t){var e=this,a="";if(i.localStorage.getItem("userinfo")){var s=JSON.parse(i.localStorage.getItem("userinfo"));a=s.token}var n={uid:t,token:a};uni.showModal({title:"确定要解封该用户吗",success:function(t){t.confirm?(uni.showLoading({title:"加载中"}),e.$Net.request({url:e.$API.unblockUser(),data:n,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:t.data.msg,icon:"none"}),1==t.data.code&&(e.page=1,e.getUserList())},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"})}})):t.cancel&&console.log("用户点击取消")}})},getUser:function(t){i.localStorage.setItem("getuid",t.uid),this.back()},toUserContents:function(t){var e=t.name,a=t.name+"的信息";t.screenName&&(a=t.screenName+" 的信息",e=t.screenName);var i=t.uid;uni.navigateTo({url:"/pages/contents/userinfo?title="+a+"&name="+e+"&uid="+i+"&avatar="+encodeURIComponent(t.avatar)})},toBan:function(t){uni.navigateTo({url:"/pages/manage/banuser?uid="+t})}}};e.default=s},"9d56":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"user",class:t.AppStyle},[i("v-uni-view",{staticClass:"header",style:[{height:t.CustomBar+"px"}]},[i("v-uni-view",{staticClass:"cu-bar bg-white",style:{height:t.CustomBar+"px","padding-top":t.StatusBar+"px"}},[i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-back"})],1),i("v-uni-view",{staticClass:"content text-bold",style:[{top:t.StatusBar+"px"}]},["get"==t.type?[t._v("用户选择")]:t._e(),""==t.type?[t._v("用户管理")]:t._e()],2),i("v-uni-view",{staticClass:"action"})],1)],1),i("v-uni-view",{style:[{padding:t.NavBar+"px 10px 0px 10px"}]}),i("v-uni-view",{staticClass:"cu-list menu-avatar userList",staticStyle:{"margin-top":"20upx"}},[i("v-uni-view",{staticClass:"cu-bar bg-white search"},[i("v-uni-view",{staticClass:"search-form round"},[i("v-uni-text",{staticClass:"cuIcon-search"}),i("v-uni-input",{attrs:{type:"text",placeholder:"输入搜索关键字"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.searchTag.apply(void 0,arguments)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),""!=t.searchText?i("v-uni-view",{staticClass:"search-close",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.searchClose()}}},[i("v-uni-text",{staticClass:"cuIcon-close"})],1):t._e()],1)],1),i("v-uni-view",{staticClass:"search-type grid col-6"},[i("v-uni-view",{staticClass:"search-type-box ",class:"all"==t.dataType?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getType("all")}}},[i("v-uni-text",[t._v("全部")])],1),i("v-uni-view",{staticClass:"search-type-box",class:"contributor"==t.dataType?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getType("contributor")}}},[i("v-uni-text",[t._v("贡献者")])],1),i("v-uni-view",{staticClass:"search-type-box",class:"administrator"==t.dataType?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getType("administrator")}}},[i("v-uni-text",[t._v("管理员")])],1),i("v-uni-view",{staticClass:"search-type-box",class:"editor"==t.dataType?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getType("editor")}}},[i("v-uni-text",[t._v("编辑")])],1),i("v-uni-view",{staticClass:"search-type-box",class:"vip"==t.dataType?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getType("vip")}}},[i("v-uni-text",[t._v("VIP")])],1),i("v-uni-view",{staticClass:"search-type-box",class:"ban"==t.dataType?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getType("ban")}}},[i("v-uni-text",[t._v("封禁")])],1)],1),0==t.userList.length?i("v-uni-view",{staticClass:"no-data"},[i("v-uni-text",{staticClass:"cuIcon-text"}),t._v("暂时没有数据")],1):t._e(),t._l(t.userList,(function(e,a){return i("v-uni-view",{key:a,staticClass:"cu-item"},[i("v-uni-view",{staticClass:"cu-avatar round lg",style:e.style,on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.toUserContents(e)}}}),i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"text-grey"},[e.screenName?[t._v(t._s(e.screenName))]:[t._v(t._s(e.name))],"contributor"==e.groupKey||"administrator"==e.groupKey?i("v-uni-text",{staticClass:"cuIcon-lightfill"}):t._e(),e.isvip>0?[1==e.vip?[i("v-uni-text",{staticClass:"isVIP bg-gradual-red"},[t._v("VIP")])]:[i("v-uni-text",{staticClass:"isVIP bg-yellow"},[t._v("VIP")])]]:t._e()],2),i("v-uni-view",{staticClass:"text-gray text-sm flex"},[i("v-uni-view",{staticClass:"text-cut"},[t._v("UID:"+t._s(e.uid)+"  积分:"),i("v-uni-text",{staticClass:"text-blue"},[t._v(t._s(e.assets))])],1)],1)],1),i("v-uni-view",{staticClass:"action user-list-btn"},[""==t.type?["ban"==t.dataType?[i("v-uni-view",{staticClass:"cu-btn text-black radius",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.unblockUser(e.uid)}}},[t._v("解封")])]:["administrator"==t.group?i("v-uni-view",{staticClass:"cu-btn text-red radius",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.deleteUser(e.uid)}}},[i("v-uni-text",{staticClass:"cuIcon-deletefill"})],1):t._e(),"administrator"==t.group?i("v-uni-view",{staticClass:"cu-btn text-blue radius",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.toEdit(e.uid)}}},[i("v-uni-text",{staticClass:"cuIcon-post"})],1):t._e(),i("v-uni-view",{staticClass:"cu-btn text-black radius",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.toBan(e.uid)}}},[i("v-uni-text",{staticClass:"cuIcon-warnfill"})],1)]]:t._e(),"get"==t.type?[i("v-uni-view",{staticClass:"cu-btn text-blue radius",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.getUser(e)}}},[t._v("选择")])]:t._e()],2)],1)})),t.userList.length>0?i("v-uni-view",{staticClass:"load-more",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.loadMore.apply(void 0,arguments)}}},[i("v-uni-text",[t._v(t._s(t.moreText))])],1):t._e()],2),0==t.isLoading?i("v-uni-view",{staticClass:"loading"},[i("v-uni-view",{staticClass:"loading-main"},[i("v-uni-image",{attrs:{src:a("14d6")}})],1)],1):t._e()],1)},s=[]},e675:function(t,e,a){"use strict";a.r(e);var i=a("9d56"),s=a("3421");for(var n in s)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return s[t]}))}(n);var o=a("f0c5"),c=Object(o["a"])(s["default"],i["b"],i["c"],!1,null,"dea3227a",null,!1,i["a"],void 0);e["default"]=c.exports}}]);