(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-addGroup"],{1290:function(t,e,n){"use strict";n("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("d401"),n("d3b7"),n("25f0"),n("c975"),n("fb6a"),n("a9e3");var a=n("625a"),i=n("bfa7"),o={data:function(){return{StatusBar:this.StatusBar,CustomBar:this.CustomBar,NavBar:this.StatusBar+this.CustomBar,AppStyle:this.$store.state.AppStyle,modalName:"",token:"",name:"",avatar:"",avatarNew:"",postType:"add",isLoading:1}},onPullDownRefresh:function(){},onShow:function(){if(a.localStorage.getItem("toAvatar")){var t=JSON.parse(a.localStorage.getItem("toAvatar"));this.avatarUpload(t.dataUrl)}else console.log("没有图片缓存")},onLoad:function(t){a.localStorage.getItem("token")&&(this.token=a.localStorage.getItem("token")),t.postType&&(this.postType=t.postType,"edit"==this.postType&&(t.chatid?(this.chatid=t.chatid,this.getGroupInfo(this.chatid)):uni.showToast({title:"无参数访问",icon:"none"})))},methods:{total:function(t,e){if(""!=t){var n=t*e;return n}return 0},showModal:function(t){this.modalName=t.currentTarget.dataset.target},hideModal:function(t){this.modalName=null},RadioChange:function(t){this.urltype=t.detail.value,this.modalName=null},back:function(){uni.navigateBack({delta:1})},isRealNum:function(t){return""!==t&&null!=t&&!isNaN(t)},limit:function(t,e){if(this.isRealNum(t)){var n=t.toString();if(-1!=n.indexOf(".")){var a=n.split("."),i=a[0],o=a[1];o.length>e&&(o=o.slice(0,e)),n=Number(i)+"."+o,t=n}}else t=t.substr(0,t.length-1),t=this.isRealNum(t)?t:"";return t},imgUpload:function(){var t=this;uni.chooseImage({count:1,sourceType:["album","camera"],success:function(e){uni.showLoading({title:"加载中"});var n=e.tempFilePaths,a=uni.uploadFile({url:t.$API.upload(),filePath:n[0],name:"file",formData:{token:t.token},success:function(e){setTimeout((function(){uni.hideLoading()}),1e3);var n=JSON.parse(e.data);uni.showToast({title:n.msg,icon:"none"}),1==n.code&&(t.imgurl=n.data.url)},fail:function(){setTimeout((function(){uni.hideLoading()}),1e3)}});a.onProgressUpdate((function(t){}))}})},submit:function(){var t=this;if(""==t.name||""==t.avatar)return uni.showToast({title:"请完成表单填写",icon:"none",duration:1e3,position:"bottom"}),!1;var e={name:t.name,pic:t.avatar,token:t.token};uni.showLoading({title:"加载中"}),t.$Net.request({url:t.$API.createGroup(),data:t.$API.removeObjectEmptyKey(e),header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){if(setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:e.data.msg,icon:"none"}),1==e.data.code)setTimeout((function(){t.back()}),1e3)},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"}),uni.stopPullDownRefresh()}})},edit:function(){var t=this;if(""==t.name||""==t.avatar)return uni.showToast({title:"请完成表单填写",icon:"none",duration:1e3,position:"bottom"}),!1;var e={id:t.chatid,name:t.name,pic:t.avatar,token:t.token};uni.showLoading({title:"加载中"}),t.$Net.request({url:t.$API.editGroup(),data:t.$API.removeObjectEmptyKey(e),header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){if(setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:e.data.msg,icon:"none"}),1==e.data.code)setTimeout((function(){t.back()}),1e3)},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"}),uni.stopPullDownRefresh()}})},avatarUpload:function(t){var e=this;(0,i.base64ToPath)(t).then((function(t){var n=t;uni.uploadFile({url:e.$API.upload(),filePath:n,name:"file",formData:{token:e.token},success:function(t){setTimeout((function(){uni.hideLoading()}),1e3);var n=JSON.parse(t.data);1==n.code?(e.avatar=n.data.url,e.avatarNew=n.data.url,a.localStorage.removeItem("toAvatar")):uni.showToast({title:"头像上传失败，请检查接口",icon:"none"})},fail:function(){setTimeout((function(){uni.hideLoading()}),1e3)}})})).catch((function(t){console.error("失败"+t)}))},getGroupInfo:function(t){var e=this,n={id:t};e.$Net.request({url:e.$API.groupInfo(),data:n,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){if(1==t.data.code){var n=t.data.data;e.avatar=n.pic,e.avatarNew=n.pic,e.name=n.name}},fail:function(t){}})},toAvatar:function(){uni.navigateTo({url:"../../uni_modules/buuug7-img-cropper/pages/cropper",events:{imgCropped:function(t){console.log(t)}}})}}};e.default=o},"6fb9":function(t,e,n){"use strict";n.r(e);var a=n("ebcb"),i=n("c4a9");for(var o in i)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(o);var u=n("f0c5"),r=Object(u["a"])(i["default"],a["b"],a["c"],!1,null,"7c18d47e",null,!1,a["a"],void 0);e["default"]=r.exports},bfa7:function(t,e,n){"use strict";n("7a82");var a=n("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.base64ToPath=function(t){return new Promise((function(e,n){if("object"===("undefined"===typeof window?"undefined":(0,i.default)(window))&&"document"in window){t=t.split(",");var a=t[0].match(/:(.*?);/)[1],r=atob(t[1]),s=r.length,c=new Uint8Array(s);while(s--)c[s]=r.charCodeAt(s);return e((window.URL||window.webkitURL).createObjectURL(new Blob([c],{type:a})))}var d=t.split(",")[0].match(/data\:\S+\/(\S+);/);d?d=d[1]:n(new Error("base64 error"));var l=function(){return Date.now()+String(u++)}()+"."+d;if("object"!==("undefined"===typeof plus?"undefined":(0,i.default)(plus)))if("object"===("undefined"===typeof wx?"undefined":(0,i.default)(wx))&&wx.canIUse("getFileSystemManager")){f=wx.env.USER_DATA_PATH+"/"+l;wx.getFileSystemManager().writeFile({filePath:f,data:o(t),encoding:"base64",success:function(){e(f)},fail:function(t){n(t)}})}else n(new Error("not support"));else{var f="_doc/uniapp_temp/"+l;if(!function(t,e){for(var n=t.split("."),a=e.split("."),i=!1,o=0;o<a.length;o++){var u=n[o]-a[o];if(0!==u){i=u>0;break}}return i}("Android"===plus.os.name?"1.9.9.80627":"1.9.9.80472",plus.runtime.innerVersion))return void plus.io.resolveLocalFileSystemURL("_doc",(function(a){a.getDirectory("uniapp_temp",{create:!0,exclusive:!1},(function(a){a.getFile(l,{create:!0,exclusive:!1},(function(a){a.createWriter((function(a){a.onwrite=function(){e(f)},a.onerror=n,a.seek(0),a.writeAsBinary(o(t))}),n)}),n)}),n)}),n);var p=new plus.nativeObj.Bitmap(l);p.loadBase64Data(t,(function(){p.save(f,{},(function(){p.clear(),e(f)}),(function(t){p.clear(),n(t)}))}),(function(t){p.clear(),n(t)}))}}))},e.pathToBase64=function(t){return new Promise((function(e,n){if("object"===("undefined"===typeof window?"undefined":(0,i.default)(window))&&"document"in window){if("function"===typeof FileReader){var a=new XMLHttpRequest;return a.open("GET",t,!0),a.responseType="blob",a.onload=function(){if(200===this.status){var t=new FileReader;t.onload=function(t){e(t.target.result)},t.onerror=n,t.readAsDataURL(this.response)}},a.onerror=n,void a.send()}var o=document.createElement("canvas"),u=o.getContext("2d"),r=new Image;return r.onload=function(){o.width=r.width,o.height=r.height,u.drawImage(r,0,0),e(o.toDataURL()),o.height=o.width=0},r.onerror=n,void(r.src=t)}"object"!==("undefined"===typeof plus?"undefined":(0,i.default)(plus))?"object"===("undefined"===typeof wx?"undefined":(0,i.default)(wx))&&wx.canIUse("getFileSystemManager")?wx.getFileSystemManager().readFile({filePath:t,encoding:"base64",success:function(t){e("data:image/png;base64,"+t.data)},fail:function(t){n(t)}}):n(new Error("not support")):plus.io.resolveLocalFileSystemURL(function(t){if(0===t.indexOf("_www")||0===t.indexOf("_doc")||0===t.indexOf("_documents")||0===t.indexOf("_downloads"))return t;if(0===t.indexOf("file://"))return t;if(0===t.indexOf("/storage/emulated/0/"))return t;if(0===t.indexOf("/")){var e=plus.io.convertAbsoluteFileSystem(t);if(e!==t)return e;t=t.substr(1)}return"_www/"+t}(t),(function(t){t.file((function(t){var a=new plus.io.FileReader;a.onload=function(t){e(t.target.result)},a.onerror=function(t){n(t)},a.readAsDataURL(t)}),(function(t){n(t)}))}),(function(t){n(t)}))}))};var i=a(n("0122"));function o(t){var e=t.split(",");return e[e.length-1]}n("c975"),n("d3b7"),n("d9e2"),n("d401"),n("ac1f"),n("466d"),n("81b2"),n("0eb6"),n("b7ef"),n("8bd4"),n("ace4"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("986a"),n("1d02"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("b39a"),n("72f7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861");var u=0},c4a9:function(t,e,n){"use strict";n.r(e);var a=n("1290"),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=i.a},ebcb:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"user",class:t.AppStyle},[a("v-uni-view",{staticClass:"header",style:[{height:t.CustomBar+"px"}]},[a("v-uni-view",{staticClass:"cu-bar bg-white",style:{height:t.CustomBar+"px","padding-top":t.StatusBar+"px"}},[a("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"cuIcon-back"})],1),a("v-uni-view",{staticClass:"content text-bold",style:[{top:t.StatusBar+"px"}]},["edit"==t.postType?[t._v("编辑")]:[t._v("新建")],t._v("群聊")],2),"edit"==t.postType?[a("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.edit.apply(void 0,arguments)}}},[a("v-uni-button",{staticClass:"cu-btn round bg-blue"},[t._v("创建")])],1)]:[a("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[a("v-uni-button",{staticClass:"cu-btn round bg-blue"},[t._v("保存")])],1)]],2)],1),a("v-uni-view",{style:[{padding:t.NavBar+"px 10px 0px 10px"}]}),a("v-uni-form",[a("v-uni-view",{staticClass:"user-edit-header margin-top"},[a("v-uni-image",{attrs:{src:t.avatar}}),a("v-uni-text",{staticClass:"cu-btn bg-blue radius",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toAvatar.apply(void 0,arguments)}}},[t._v("设置头像")])],1),a("v-uni-view",{staticClass:"cu-form-group margin-top"},[a("v-uni-view",{staticClass:"title"},[t._v("群聊名称")]),a("v-uni-input",{attrs:{placeholder:"输入群聊名称",name:"input","adjust-position":!1,focus:!1},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),0==t.isLoading?a("v-uni-view",{staticClass:"loading"},[a("v-uni-view",{staticClass:"loading-main"},[a("v-uni-image",{attrs:{src:n("14d6")}})],1)],1):t._e()],1)},i=[]}}]);