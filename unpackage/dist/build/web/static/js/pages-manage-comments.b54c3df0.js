(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-manage-comments"],{"38f4":function(t,e,i){"use strict";i.r(e);var a=i("5acd"),n=i.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},4053:function(t,e,i){"use strict";i.r(e);var a=i("7b4a"),n=i("38f4");for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);var o=i("f0c5"),c=Object(o["a"])(n["default"],a["b"],a["c"],!1,null,"2fbedb1c",null,!1,a["a"],void 0);e["default"]=c.exports},"5acd":function(t,e,i){"use strict";i("7a82");var a=i("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("fc11"));i("99af"),i("c975"),i("ac1f"),i("5319"),i("5b81"),i("1276"),i("e9c4"),i("14d9"),i("e25e"),i("fb6a");var s,o=i("625a"),c=a(i("634b")),u={data:function(){return{StatusBar:this.StatusBar,CustomBar:this.CustomBar,NavBar:this.StatusBar+this.CustomBar,AppStyle:this.$store.state.AppStyle,commentsList:[],moreText:"加载更多",page:1,searchText:"",status:"waiting",isLoading:0,owo:c.default,owoList:[],group:""}},onPullDownRefresh:function(){this.page=1,this.getCommentsList(!1);setTimeout((function(){uni.stopPullDownRefresh()}),1e3)},onReachBottom:function(){this.loadMore()},onShow:function(){if(this.page=1,o.localStorage.getItem("userinfo")){var t=JSON.parse(o.localStorage.getItem("userinfo"));this.group=t.group}},onLoad:function(){var t=this.owo.data,e=[];for(var i in t)e=e.concat(t[i].container);this.owoList=e,this.getCommentsList(!1)},methods:(s={back:function(){uni.navigateBack({delta:1})},markHtml:function(t){var e=this.owoList;for(var i in e)-1!=this.replaceSpecialChar(t).indexOf(e[i].data)&&(t=this.replaceAll(this.replaceSpecialChar(t),e[i].data,"<img src='/"+e[i].icon+"' class='tImg' />"));return t},replaceAll:function(t,e,i){return t.split(e).join(i)},searchTag:function(){this.searchText;this.page=1,this.getCommentsList()},getUserLv:function(t){if(!t)t=0;var e=this.$API.GetRankList();return e[t]},getUserLvStyle:function(t){if(!t)t=0;var e=this.$API.GetRankStyle(),i="color:#fff;background-color: "+e[t];return i},loadMore:function(){this.moreText="正在加载中...",0==this.isLoad&&this.getCommentsList(!0)},toInfo:function(t,e){uni.navigateTo({url:"/pages/contents/info?cid="+t+"&title="+e})}},(0,n.default)(s,"searchTag",(function(){this.searchText;this.page=1,this.getCommentsList()})),(0,n.default)(s,"getCommentsList",(function(t){var e=this,i={type:"comment",status:e.status},a=e.page;t&&a++,e.$Net.request({url:e.$API.getCommentsList(),data:{searchParams:JSON.stringify(e.$API.removeObjectEmptyKey(i)),limit:5,page:a,searchKey:e.searchText},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(i){if(e.isLoad=0,1==i.data.code){var a=i.data.data;if(a.length>0){var n=[];for(var s in a){var o=a[s];o.style="background-image:url("+a[s].avatar+");",n.push(o)}t?(e.page++,e.commentsList=e.commentsList.concat(n)):e.commentsList=n}else e.moreText="没有更多评论了",t||(e.commentsList=a)}setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)},fail:function(t){e.isLoad=0,e.moreText="加载更多";setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)}})})),(0,n.default)(s,"toStatus",(function(t){this.status=t,this.page=1,this.moreText="加载更多",this.isLoad=0,this.getCommentsList(!1)})),(0,n.default)(s,"commentsAdd",(function(t,e,i,a){uni.navigateTo({url:"/pages/contents/commentsadd?cid="+a+"&coid="+e+"&title="+t+"&isreply="+i})})),(0,n.default)(s,"formatDate",(function(t){t=new Date(parseInt(1e3*t));var e=t.getFullYear(),i=("0"+(t.getMonth()+1)).slice(-2),a=("0"+t.getDate()).slice(-2),n=("0"+t.getHours()).slice(-2),s=("0"+t.getMinutes()).slice(-2),o=e+"-"+i+"-"+a+" "+n+":"+s;return o})),(0,n.default)(s,"toDelete",(function(t){var e=this,i="";if(o.localStorage.getItem("userinfo")){var a=JSON.parse(o.localStorage.getItem("userinfo"));i=a.token}var n={key:t,token:i};uni.showModal({title:"确定要删除该评论吗",success:function(t){t.confirm?(uni.showLoading({title:"加载中"}),e.$Net.request({url:e.$API.commentsDelete(),data:n,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:t.data.msg,icon:"none"}),1==t.data.code&&e.getCommentsList()},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"})}})):t.cancel&&console.log("用户点击取消")}})})),(0,n.default)(s,"toAudit",(function(t){var e=this,i="";if(o.localStorage.getItem("userinfo")){var a=JSON.parse(o.localStorage.getItem("userinfo"));i=a.token}var n={key:t,token:i};uni.showModal({title:"确定要通过审核吗？",success:function(t){t.confirm?(uni.showLoading({title:"加载中"}),e.$Net.request({url:e.$API.commentsAudit(),data:n,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:t.data.msg,icon:"none"}),1==t.data.code&&(e.page=1,e.moreText="加载更多",e.isLoad=0,e.getCommentsList())},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"})}})):t.cancel&&console.log("用户点击取消")}})})),(0,n.default)(s,"replaceSpecialChar",(function(t){return!!t&&(t=t.replace(/&quot;/g,'"'),t=t.replace(/&amp;/g,"&"),t=t.replace(/&lt;/g,"<"),t=t.replace(/&gt;/g,">"),t=t.replace(/&nbsp;/g," "),t)})),(0,n.default)(s,"getLv",(function(t){if(!t)t=0;var e=this.$API.getLever(t),i=this.$API.GetLeverList();return i[e]})),(0,n.default)(s,"getLvStyle",(function(t){if(!t)t=0;var e=this.$API.getLever(t),i=this.$API.GetRankStyle(),a="color:#fff;background-color: "+i[e];return a})),s)};e.default=u},"7b4a":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"user",class:t.AppStyle},[a("v-uni-view",{staticClass:"header",style:[{height:t.CustomBar+"px"}]},[a("v-uni-view",{staticClass:"cu-bar bg-white",style:{height:t.CustomBar+"px","padding-top":t.StatusBar+"px"}},[a("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"cuIcon-back"})],1),a("v-uni-view",{staticClass:"content text-bold",style:[{top:t.StatusBar+"px"}]},[t._v("评论管理")]),a("v-uni-view",{staticClass:"action"})],1)],1),a("v-uni-view",{style:[{padding:t.NavBar+"px 10px 0px 10px"}]}),a("v-uni-view",{staticClass:"cu-card dynamic no-card",staticStyle:{"margin-top":"20upx"}},[a("v-uni-view",{staticClass:"cu-bar bg-white search"},[a("v-uni-view",{staticClass:"search-form round"},[a("v-uni-text",{staticClass:"cuIcon-search"}),a("v-uni-input",{attrs:{type:"text",placeholder:"输入搜索关键字"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.searchTag.apply(void 0,arguments)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}})],1)],1),a("v-uni-view",{staticClass:"search-type grid col-2"},[a("v-uni-view",{staticClass:"search-type-box",class:"waiting"==t.status?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toStatus("waiting")}}},[a("v-uni-text",[t._v("待审核")])],1),a("v-uni-view",{staticClass:"search-type-box",class:"approved"==t.status?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toStatus("approved")}}},[a("v-uni-text",[t._v("已发布")])],1)],1),a("v-uni-view",{staticClass:"cu-item"},[a("v-uni-view",{staticClass:"cu-list menu-avatar comment"},[0==t.commentsList.length?a("v-uni-view",{staticClass:"no-data"},[t._v("暂时没有评论")]):t._e(),a("v-uni-view",{staticClass:"cu-card dynamic no-card",staticStyle:{"margin-top":"20upx"}},t._l(t.commentsList,(function(e,i){return t.commentsList.length>0?a("v-uni-view",{key:i,staticClass:"cu-item"},[a("v-uni-view",{staticClass:"cu-list menu-avatar comment"},[a("v-uni-view",{staticClass:"cu-item"},[a("v-uni-view",{staticClass:"cu-avatar round",style:e.style}),a("v-uni-view",{staticClass:"content"},[a("v-uni-view",{staticClass:"text-grey"},[t._v(t._s(e.author)),a("v-uni-text",{staticClass:"userlv",style:t.getLvStyle(e.experience)},[t._v(t._s(t.getLv(e.experience)))]),e.customize&&""!=e.customize?a("v-uni-text",{staticClass:"userlv customize"},[t._v(t._s(e.customize))]):t._e()],1),a("v-uni-view",{staticClass:"text-content text-df break-all"},[a("v-uni-rich-text",{attrs:{nodes:t.markHtml(e.text)}})],1),a("v-uni-view",{staticClass:"bg-grey light padding-sm radius margin-top-sm  text-sm"},[a("v-uni-view",{staticClass:"flex",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toInfo(e.cid,e.contenTitle)}}},[a("v-uni-view",[t._v(t._s(e.contenTitle))])],1)],1),a("v-uni-view",{staticClass:"margin-top-sm flex justify-between"},[a("v-uni-view",{staticClass:"text-gray text-df"},[t._v(t._s(t.formatDate(e.created)))]),a("v-uni-view",[a("v-uni-text",{staticClass:"cuIcon-messagefill text-gray margin-left-sm",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.commentsAdd(e.author+"："+e.text,e.coid,1,e.cid)}}})],1)],1)],1),"waiting"==e.status?a("v-uni-text",{staticClass:"cu-btn text-blue comment-audit",class:"editor"==t.group?"editorStyle":"",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toAudit(e.coid)}}},[t._v("审核")]):t._e(),a("v-uni-text",{staticClass:"cu-btn text-red comment-delete",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toDelete(e.coid)}}},[t._v("删除")])],1)],1)],1):t._e()})),1),t.commentsList.length>0?a("v-uni-view",{staticClass:"load-more",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.loadMore.apply(void 0,arguments)}}},[a("v-uni-text",[t._v(t._s(t.moreText))])],1):t._e()],1)],1)],1),0==t.isLoading?a("v-uni-view",{staticClass:"loading"},[a("v-uni-view",{staticClass:"loading-main"},[a("v-uni-image",{attrs:{src:i("14d6")}})],1)],1):t._e()],1)},n=[]}}]);