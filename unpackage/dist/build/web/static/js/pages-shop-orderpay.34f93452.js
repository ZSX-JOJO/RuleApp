(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-shop-orderpay"],{3903:function(t,e,i){"use strict";i("7a82");var n=i("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n(i("fc11"));i("ac1f"),i("5319"),i("5b81"),i("1276");var a,o=n(i("631a")),u=i("625a"),r={data:function(){return{StatusBar:this.StatusBar,CustomBar:this.CustomBar,NavBar:this.StatusBar+this.CustomBar,AppStyle:this.$store.state.AppStyle,switchA:!1,userInfo:"",sid:0,vipDiscount:0,shopinfo:null,vipPrice:0,scale:0,isvip:0,vip:0,currencyName:"",isLoading:0,assets:0}},components:{mpHtml:o.default},onReachBottom:function(){},onShow:function(){this.getVipInfo(),this.userStatus()},onPullDownRefresh:function(){this.getInfo(this.sid)},onLoad:function(t){this.currencyName=this.$API.getCurrencyName(),t.sid&&(this.sid=t.sid,this.getInfo(this.sid))},methods:(a={back:function(){uni.navigateBack({delta:1})},getInfo:function(t){var e=this,i="";u.localStorage.getItem("token")&&(i=u.localStorage.getItem("token"));var n={key:e.sid,token:i};e.$Net.request({url:e.$API.shopInfo(),data:n,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){uni.stopPullDownRefresh(),t.data.value;setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)},fail:function(t){uni.stopPullDownRefresh(),uni.showToast({title:"网络开小差了哦",icon:"none"});setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)}})},quillHtml:function(t){return t=this.replaceAll(t,"hljs","hl"),t=this.replaceAll(t,"ql-syntax","hl-pre"),t=this.markExpand(t),t},replaceAll:function(t,e,i){return t.split(e).join(i)},SwitchA:function(t){this.switchA=t.detail.value},getVipInfo:function(){var t=this;t.$Net.request({url:t.$API.getVipInfo(),header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){1==e.data.code&&(t.vipPrice=e.data.data.vipPrice,t.scale=e.data.data.scale);setTimeout((function(){t.isLoading=1,clearTimeout("timer")}),300)},fail:function(e){setTimeout((function(){t.isLoading=1,clearTimeout("timer")}),300)}})},userStatus:function(){var t=this,e="";if(u.localStorage.getItem("userinfo")){var i=JSON.parse(u.localStorage.getItem("userinfo"));e=i.token}t.$Net.request({url:t.$API.userStatus(),data:{token:e},header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(e){1==e.data.code&&(t.vip=e.data.data.vip,t.isvip=e.data.data.isvip,t.assets=e.data.data.assets)},fail:function(t){uni.showToast({title:"网络开小差了哦",icon:"none"})}})}},(0,s.default)(a,"getInfo",(function(t){var e=this,i={key:e.sid};e.$Net.request({url:e.$API.shopInfo(),data:i,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){e.shopinfo=t.data;setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)},fail:function(t){uni.stopPullDownRefresh(),uni.showToast({title:"网络开小差了哦",icon:"none"});setTimeout((function(){e.isLoading=1,clearTimeout("timer")}),300)}})})),(0,s.default)(a,"shopBuy",(function(){var t="";if(!u.localStorage.getItem("userinfo")){uni.showToast({title:"请先登录",icon:"none",duration:1e3,position:"bottom"});setTimeout((function(){uni.navigateTo({url:"../user/login"}),clearTimeout("timer")}),1e3);return!1}var e=JSON.parse(u.localStorage.getItem("userinfo"));t=e.token;var i={token:t,sid:this.sid};uni.showLoading({title:"加载中"}),this.$Net.request({url:this.$API.buyShop(),data:i,header:{"Content-Type":"application/x-www-form-urlencoded"},method:"get",dataType:"json",success:function(t){if(setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:t.data.msg,icon:"none"}),1==t.data.code)setTimeout((function(){uni.redirectTo({url:"/pages/user/order"}),clearTimeout("timer")}),1e3);else if("购买实体商品前，需要先设置收货地址"==t.data.msg)setTimeout((function(){uni.redirectTo({url:"/pages/user/address"}),clearTimeout("timer")}),1e3)},fail:function(t){setTimeout((function(){uni.hideLoading()}),1e3),uni.showToast({title:"网络开小差了哦",icon:"none"})}})})),a)};e.default=r},"69e0":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"user",class:t.$store.state.AppStyle},[n("v-uni-view",{staticClass:"header",style:[{height:t.CustomBar+"px"}]},[n("v-uni-view",{staticClass:"cu-bar bg-white",style:{height:t.CustomBar+"px","padding-top":t.StatusBar+"px"}},[n("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"cuIcon-back"})],1),n("v-uni-view",{staticClass:"content text-bold",style:[{top:t.StatusBar+"px"}]},[t._v("确认购买")]),n("v-uni-view",{staticClass:"action"})],1)],1),n("v-uni-view",{style:[{padding:t.NavBar+"px 10px 0px 10px"}]}),n("v-uni-view",{staticClass:"shop-order",staticStyle:{"margin-top":"10upx"}},[null!=t.shopinfo?n("v-uni-view",{staticClass:"shop-order-concent"},[n("v-uni-view",{staticClass:"shop-order-img"},[n("v-uni-image",{attrs:{src:t.shopinfo.imgurl,mode:"widthFix"}})],1),n("v-uni-view",{staticClass:"shop-order-title"},[t._v(t._s(t.shopinfo.title))])],1):t._e(),null!=t.shopinfo?n("v-uni-view",{staticClass:"shop-order-form"},[n("v-uni-view",{staticClass:"cu-form-group margin-top"},[n("v-uni-view",{staticClass:"title"},[t._v("商品价格")]),n("v-uni-view",{staticClass:"action"},[n("v-uni-text",{staticClass:"text-red text-bold text-lg margin-right-xs"},[1==t.isvip?[t._v(t._s(parseInt(t.shopinfo.price*t.shopinfo.vipDiscount)))]:[t._v(t._s(t.shopinfo.price))]],2),t._v(t._s(t.currencyName))],1)],1),n("v-uni-view",{staticClass:"cu-form-group"},[n("v-uni-view",{staticClass:"title"},[t._v("剩余数量")]),n("v-uni-view",{staticClass:"action"},[n("v-uni-text",{staticClass:"text-blue text-bold text-lg margin-right-xs"},[t._v(t._s(t.shopinfo.num))])],1)],1),n("v-uni-view",{staticClass:"cu-form-group  margin-top"},[n("v-uni-view",{staticClass:"title"},[t._v("我的资产")]),n("v-uni-view",{staticClass:"action"},[n("v-uni-text",{staticClass:"text-blue text-bold text-lg margin-right-xs"},[t._v(t._s(t.assets))]),t._v(t._s(t.currencyName))],1)],1),n("v-uni-view",{staticClass:"shop-order-btn padding flex flex-direction"},[n("v-uni-button",{staticClass:"cu-btn bg-green lg",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.shopBuy()}}},[t._v("确认购买")])],1)],1):t._e()],1),0==t.isLoading?n("v-uni-view",{staticClass:"loading"},[n("v-uni-view",{staticClass:"loading-main"},[n("v-uni-image",{attrs:{src:i("14d6")}})],1)],1):t._e()],1)},s=[]},8983:function(t,e,i){"use strict";i.r(e);var n=i("69e0"),s=i("a99d");for(var a in s)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(a);var o=i("f0c5"),u=Object(o["a"])(s["default"],n["b"],n["c"],!1,null,"5b5983c1",null,!1,n["a"],void 0);e["default"]=u.exports},a99d:function(t,e,i){"use strict";i.r(e);var n=i("3903"),s=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=s.a}}]);